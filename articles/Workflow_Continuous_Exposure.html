<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Workflow: Continuous Exposure • devMSMs</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="Workflow_Continuous_Exposure_files/libs/quarto-html/popper.min.js"></script><script src="Workflow_Continuous_Exposure_files/libs/quarto-html/tippy.umd.min.js"></script><link href="Workflow_Continuous_Exposure_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Workflow_Continuous_Exposure_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Workflow: Continuous Exposure">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">devMSMs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Terminology.html">Terminology</a></li>
    <li><a class="dropdown-item" href="../articles/Specify_Core_Inputs.html">Specify Core Inputs</a></li>
    <li><a class="dropdown-item" href="../articles/Data_Requirements.html">Data Requirements &amp; Preparation</a></li>
    <li><a class="dropdown-item" href="../articles/Workflow_Continuous_Exposure.html">Workflow for Continous Exposures</a></li>
    <li><a class="dropdown-item" href="../articles/Assessing_Balance_Tv.html">Assessing Balance for Time-Varying Exposures</a></li>
    <li><a class="dropdown-item" href="../articles/Customize_Balancing_Formulas.html">Customizing Weights Formulas</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/istallworthy/devMSMs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Workflow: Continuous Exposure</h1>

      <p class="author">Isabella Stallworthy</p>
      <p class="date">2025-08-27</p>

      <small class="dont-index">Source: <a href="https://github.com/istallworthy/devMSMs/blob/main/vignettes/Workflow_Continuous_Exposure.qmd" class="external-link"><code>vignettes/Workflow_Continuous_Exposure.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>This vignette guides a user through the process of using <em>devMSMs</em> to fit marginal structural models (MSMs) with a a continuously distributed exposure variable. The users should first view the <a href="https://istallworthy.github.io/devMSMs/articles/Terminology.html">Terminology</a>, <a href="https://istallworthy.github.io/devMSMs/articles/Data_Requirements.html">Data Requirements</a>, and <a href="https://istallworthy.github.io/devMSMs/articles/Specify_Core_Inputs.html">Specifying Core Inputs</a> vignettes.</p>
<p>The code contained in this vignette is also available, integrated code from the other vignettes, in the <a href="https://github.com/istallworthy/devMSMs/blob/main/ExampleWorkflow.Rmd" class="external-link">ExampleWorkflow.rmd file</a>. This workflow is designed to complement the conceptual and high-level practical details provided in the manuscript (<a href="https://osf.io/preprints/psyarxiv/284mb" class="external-link">preprintgh</a>). We strongly suggest users familiarize themselves with concepts of the MSM process outlined in the manuscript and the practical steps and functions put forth in the following sections before implementing this workflow. <br></p>
<section class="section level2"><h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Until <em>devMSMs</em> is available on CRAN, you will need to install it directly from Github (https://github.com/istallworthy/devMSMs), as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRAN <span class="op">=</span> <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"istallworthy/devMSMs"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://istallworthy.github.io/devMSMs/">devMSMs</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"istallworthy/devMSMsHelpers"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">devMSMsHelpers</span><span class="op">)</span></span></code></pre></div>
</div>
<p>All <em>devMSMs</em> functions have an option to save out objects as ‘.rds’ files. Users can also save out content from print, summary, and plot methods, as illustrated in the sections below. To save, users must supply a path to a home directory (<code>home_dir</code>) when creating their initial MSM object. Users can save to the home directory using the default file labels (and .txt file type) using <code>save.out</code> = TRUE. When saving tables, users have the option to supply their own name and file type (e.g., <code>save.out</code> = “custom_name.png”). Allowable file types are: .png, .html, .pdf, .tex, and .md. All sub-folders referenced by each function are created automatically within the home directory. We recommend saving outputs for future use and provide commented out examples here. When an output is saved out, the function automatically provides a path file to aid the user in reading in that output in the future.</p>
<p>Some functions output tables. These are all from the <em>tinytables</em> package and can be further customized (e.g., dimensions, footnotes, captions, combined, etc.) according to the options provided by the package (https://vincentarelbundock.github.io/tinytable/vignettes/tinytable.html).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">save.out</span> <span class="op">=</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
<p><br></p>
</section><section class="section level2"><h2 id="phase-0-preliminary-conceptual-data-preparation">Phase 0: Preliminary Conceptual &amp; Data Preparation<a class="anchor" aria-label="anchor" href="#phase-0-preliminary-conceptual-data-preparation"></a>
</h2>
<p>Please see the accompanying manuscript for steps P1 (creating hypotheses) and P2 (creating a DAG).</p>
<section class="level2"><h3 id="step-p3--specify-core-inputs">STEP P3. Specify Core Inputs<a class="anchor" aria-label="anchor" href="#step-p3--specify-core-inputs"></a>
</h3>
<p>The first step is to create an initial MSM object by specifying the core variables and data for use with the package. Please see the <a href="https://istallworthy.github.io/devMSMs/articles/Specify_Core_Inputs.html">Specifying Core Inputs vignette</a> for more detail on the following core inputs.</p>
<p>Below, we specify data, exposure, time invariant and time-varying confounders, as well as exposure epochs.</p>
<p>There are several other optional fields that a user could specify in the MSM object.</p>
<p>The user also has the option to specify <code>concur_conf</code>, indicating, as a list of character strings, the names of any time-varying confounders (e.g., “variable.time”) they wish to be included concurrently in the weights formulas (overriding the default which is to only include lagged confounders). This should only be done if the user has strong evidence to differentiate confounders from mediators in their relation with the exposure contemporaneously.</p>
<section class="level3"><h4 id="p3-1-recommended-home-directory">P3.1 Recommended: Home Directory<a class="anchor" aria-label="anchor" href="#p3-1-recommended-home-directory"></a>
</h4>
<p>We do not specify a home directory given the nature of this example, but we do recommend doing so to save out core function outputs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># home_dir = '/Users/isabella/Library/CloudStorage/Box-Box/BSL General/MSMs/testing/isa' </span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="p3-2-recommended-time-point-delimiter">P3.2 Recommended: Time Point Delimiter<a class="anchor" aria-label="anchor" href="#p3-2-recommended-time-point-delimiter"></a>
</h4>
<p>Below, we use the default period as a time delimiter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sep</span> <span class="op">&lt;-</span> <span class="st">"\\."</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="p3-3-required-exposure-variable">P3.3 Required: Exposure Variable<a class="anchor" aria-label="anchor" href="#p3-3-required-exposure-variable"></a>
</h4>
<p>We specify our 6 time points of exposure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ESETA1.6"</span>, <span class="st">"ESETA1.15"</span>, <span class="st">"ESETA1.24"</span>, <span class="st">"ESETA1.35"</span>, <span class="st">"ESETA1.58"</span><span class="op">)</span> </span></code></pre></div>
</div>
</section><section class="level3"><h4 id="p3-4--required-for-continuous-exposures-identify-high-and-low-exemplar-cutoff-values">P3.4. Required for Continuous Exposures: Identify High and Low Exemplar Cutoff Values<a class="anchor" aria-label="anchor" href="#p3-4--required-for-continuous-exposures-identify-high-and-low-exemplar-cutoff-values"></a>
</h4>
<p>Below, we specify the 60th and 30th percentiles to demarcate exemplar high and low levels of economic strain exposure, respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hi_lo_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="p3-5-optional-exposure-epochs">P3.5 Optional: Exposure Epochs<a class="anchor" aria-label="anchor" href="#p3-5-optional-exposure-epochs"></a>
</h4>
<p>We specify that the first two exposure time points (6 and 15 months) will be considered infancy, the second two (34 and 25 months) toddlerhood, and the final (58 months) childhood.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epochs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Infancy"</span>, <span class="st">"Infancy"</span>, <span class="st">"Toddlerhood"</span>, <span class="st">"Toddlerhood"</span>, <span class="st">"Childhood"</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="p3-6-recommended-hypotheses-relevant-exposure-histories">P3.6 Recommended: Hypotheses-Relevant Exposure Histories<a class="anchor" aria-label="anchor" href="#p3-6-recommended-hypotheses-relevant-exposure-histories"></a>
</h4>
<p>See the Specify Core Inputs vignette for more information.</p>
<p>Below, we specify low economic strain at all epochs (“l-l-l”) as our reference event in comparison to high levels at all epochs (“h-h-h”) to examine an example question comparing the causal effects of 0 vs 3 doses of exposure to economic strain on children’s behavior problems.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reference</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l-l-l"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h-h-h"</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="p3-7-required-outcome-variable">P3.7 Required: Outcome Variable<a class="anchor" aria-label="anchor" href="#p3-7-required-outcome-variable"></a>
</h4>
<p>We specify out outcome as behavior problems at 58 months.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcome</span> <span class="op">&lt;-</span>  <span class="st">"StrDif_Tot.58"</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="p3-8-recommended-confounders">P3.8 Recommended: Confounders<a class="anchor" aria-label="anchor" href="#p3-8-recommended-confounders"></a>
</h4>
<p>We specify both time-invariant and time-varying confounders.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ti_conf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"state"</span>, <span class="st">"BioDadInHH2"</span>, <span class="st">"PmAge2"</span>, <span class="st">"PmBlac2"</span>, <span class="st">"TcBlac2"</span>, <span class="st">"PmMrSt2"</span>, <span class="st">"PmEd2"</span>, <span class="st">"KFASTScr"</span>,</span>
<span>  <span class="st">"RMomAgeU"</span>, <span class="st">"RHealth"</span>, <span class="st">"HomeOwnd"</span>, <span class="st">"SWghtLB"</span>, <span class="st">"SurpPreg"</span>, <span class="st">"SmokTotl"</span>, <span class="st">"DrnkFreq"</span>,</span>
<span>  <span class="st">"peri_health"</span>, <span class="st">"caregiv_health"</span>, <span class="st">"gov_assist"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tv_conf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SAAmylase.6"</span>, <span class="st">"SAAmylase.15"</span>, <span class="st">"SAAmylase.24"</span>,</span>
<span>  <span class="st">"MDI.6"</span>, <span class="st">"MDI.15"</span>,</span>
<span>  <span class="st">"RHasSO.6"</span>, <span class="st">"RHasSO.15"</span>, <span class="st">"RHasSO.24"</span>, <span class="st">"RHasSO.35"</span>, </span>
<span>  <span class="st">"WndNbrhood.6"</span>, <span class="st">"WndNbrhood.24"</span>, <span class="st">"WndNbrhood.35"</span>,</span>
<span>  <span class="st">"IBRAttn.6"</span>, <span class="st">"IBRAttn.15"</span>, <span class="st">"IBRAttn.24"</span>,</span>
<span>  <span class="st">"B18Raw.6"</span>, <span class="st">"B18Raw.15"</span>, <span class="st">"B18Raw.24"</span>, </span>
<span>  <span class="st">"HOMEETA1.6"</span>, <span class="st">"HOMEETA1.15"</span>, <span class="st">"HOMEETA1.24"</span>, <span class="st">"HOMEETA1.35"</span>, </span>
<span>  <span class="st">"InRatioCor.6"</span>, <span class="st">"InRatioCor.15"</span>, <span class="st">"InRatioCor.24"</span>, <span class="st">"InRatioCor.35"</span>,</span>
<span>  <span class="st">"CORTB.6"</span>, <span class="st">"CORTB.15"</span>, <span class="st">"CORTB.24"</span>,</span>
<span>  <span class="st">"EARS_TJo.24"</span>, <span class="st">"EARS_TJo.35"</span>,</span>
<span>  <span class="st">"LESMnPos.24"</span>, <span class="st">"LESMnPos.35"</span>,</span>
<span>  <span class="st">"LESMnNeg.24"</span>, <span class="st">"LESMnNeg.35"</span>,</span>
<span>  <span class="st">"StrDif_Tot.35"</span>, </span>
<span>  <span class="st">"fscore.35"</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="p3-8c-optional-concurrent-confounders">P3.8c Optional: Concurrent Confounders<a class="anchor" aria-label="anchor" href="#p3-8c-optional-concurrent-confounders"></a>
</h4>
<p>We specify no concurrent confounders as, given our data, we are unable to disentangle them from mediators or colliders.</p>
<p><br></p>
</section></section><section class="level2"><h3 id="step-p4--data-preparation-inspection">STEP P4. Data Preparation &amp; Inspection<a class="anchor" aria-label="anchor" href="#step-p4--data-preparation-inspection"></a>
</h3>
<section class="level3"><h4 id="p4-3b--required-read-in-wide-data">P4.3b. Required: Read in Wide Data<a class="anchor" aria-label="anchor" href="#p4-3b--required-read-in-wide-data"></a>
</h4>
<p>We highly recommend first implementing the <em>Data Requirements &amp; Preparation Vignette</em> https://istallworthy.github.io/devMSMs/articles/Data_Requirements.html before assigning to the variable, <code>data</code>, one of the following wide data formats (see Figure 1) for use in the package:</p>
<ul>
<li><p>a single data frame of data in wide format with no missing data</p></li>
<li><p>a mids object (output from mice::mice()) of data imputed in wide format</p></li>
<li><p>a list of data imputed in wide format as data frames</p></li>
</ul>
<p>See the <em>Data Preparation</em> vignette for more detail.</p>
<p>We first load in 2 imputed datasets as a mice object. These data are simulated based on data from the Family Life Project (FLP), a longitudinal study following 1,292 families representative of two geographic areas (three counties in North Carolina and three counties in Pennsylvania) with high rural child poverty (Vernon-Feagans et al., 2013; Burchinal et al., 2008). We take the example exposure of economic strain (“ESETA1”) measured at 6, 15, 24, 35, and 58 months in relation to the outcome of behavior problems (“StrDif_Tot”) measured at 58 months. (See <a href="https://istallworthy.github.io/devMSMs/articles/Data_Requirements.html">Data Requirements &amp; Preparation vignette</a> for beginning with other data types, including missing data).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sim_data_mice"</span>, package <span class="op">=</span> <span class="st">"devMSMs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">sim_data_mice</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html" class="external-link">complete</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ALI_Le.35 B18Raw.15 B18Raw.24 B18Raw.58 B18Raw.6 BioDadInHH2 caregiv_health</span></span>
<span><span class="co">#&gt; 1         3         1         1         7       16           1              3</span></span>
<span><span class="co">#&gt; 2         2         4        -7         7        0           0              0</span></span>
<span><span class="co">#&gt; 3         3         6         5        20       -1           0              3</span></span>
<span><span class="co">#&gt; 4         4        24        25        17       11           0              3</span></span>
<span><span class="co">#&gt; 5         3        -8        -9        17        1           1              2</span></span>
<span><span class="co">#&gt;   CORTB.15 CORTB.24 CORTB.6</span></span>
<span><span class="co">#&gt; 1   -0.227   -0.652   0.742</span></span>
<span><span class="co">#&gt; 2    0.149    0.831   0.018</span></span>
<span><span class="co">#&gt; 3    1.145    0.033  -0.379</span></span>
<span><span class="co">#&gt; 4    0.301   -0.501   0.000</span></span>
<span><span class="co">#&gt; 5   -0.247    0.084   0.153</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="p4-4-required-create-msm-object">P4.4 Required: Create MSM Object<a class="anchor" aria-label="anchor" href="#p4-4-required-create-msm-object"></a>
</h4>
<p>We set a seed for reproducibility.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/initMSM.html">initMSM</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  exposure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ESETA1.6"</span>, <span class="st">"ESETA1.15"</span>, <span class="st">"ESETA1.24"</span>, <span class="st">"ESETA1.35"</span>, <span class="st">"ESETA1.58"</span><span class="op">)</span>,</span>
<span>  ti_conf <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>, <span class="st">"BioDadInHH2"</span>, <span class="st">"PmAge2"</span>, <span class="st">"PmBlac2"</span>, <span class="st">"TcBlac2"</span>, </span>
<span>               <span class="st">"PmMrSt2"</span>, <span class="st">"PmEd2"</span>, <span class="st">"KFASTScr"</span>,</span>
<span>               <span class="st">"RMomAgeU"</span>, <span class="st">"RHealth"</span>, <span class="st">"HomeOwnd"</span>, <span class="st">"SWghtLB"</span>, <span class="st">"SurpPreg"</span>, </span>
<span>               <span class="st">"SmokTotl"</span>, <span class="st">"DrnkFreq"</span>,</span>
<span>               <span class="st">"peri_health"</span>, <span class="st">"caregiv_health"</span>, <span class="st">"gov_assist"</span><span class="op">)</span>,</span>
<span>  tv_conf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SAAmylase.6"</span>,<span class="st">"SAAmylase.15"</span>, <span class="st">"SAAmylase.24"</span>, </span>
<span>              <span class="st">"MDI.6"</span>, <span class="st">"MDI.15"</span>,                                            </span>
<span>              <span class="st">"RHasSO.6"</span>, <span class="st">"RHasSO.15"</span>, <span class="st">"RHasSO.24"</span>,<span class="st">"RHasSO.35"</span>,                                       </span>
<span>              <span class="st">"WndNbrhood.6"</span>,<span class="st">"WndNbrhood.24"</span>, <span class="st">"WndNbrhood.35"</span>,                                      </span>
<span>              <span class="st">"IBRAttn.6"</span>, <span class="st">"IBRAttn.15"</span>, <span class="st">"IBRAttn.24"</span>,                                   </span>
<span>              <span class="st">"B18Raw.6"</span>, <span class="st">"B18Raw.15"</span>, <span class="st">"B18Raw.24"</span>,                                           </span>
<span>              <span class="st">"HOMEETA1.6"</span>, <span class="st">"HOMEETA1.15"</span>, <span class="st">"HOMEETA1.24"</span>, <span class="st">"HOMEETA1.35"</span>,                            </span>
<span>              <span class="st">"InRatioCor.6"</span>, <span class="st">"InRatioCor.15"</span>, <span class="st">"InRatioCor.24"</span>, <span class="st">"InRatioCor.35"</span>,                         </span>
<span>              <span class="st">"CORTB.6"</span>, <span class="st">"CORTB.15"</span>, <span class="st">"CORTB.24"</span>,                                                                  </span>
<span>              <span class="st">"EARS_TJo.24"</span>, <span class="st">"EARS_TJo.35"</span>,                                        </span>
<span>              <span class="st">"LESMnPos.24"</span>, <span class="st">"LESMnPos.35"</span>,                                  </span>
<span>              <span class="st">"LESMnNeg.24"</span>, <span class="st">"LESMnNeg.35"</span>,       </span>
<span>              <span class="st">"StrDif_Tot.35"</span>, </span>
<span>              <span class="st">"fscore.35"</span><span class="op">)</span>,</span>
<span>  <span class="va">epoch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Infancy"</span>, <span class="st">"Infancy"</span>, <span class="st">"Toddlerhood"</span>, <span class="st">"Toddlerhood"</span>, <span class="st">"Childhood"</span><span class="op">)</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"\\."</span></span>
<span> <span class="op">)</span></span></code></pre></div>
</div>
<p>Below, we inspect the MSMS object to view and confirm how variables are categorized.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; Exposure (continuous): ESETA1.6, ESETA1.15, ESETA1.24, ESETA1.35, ESETA1.58</span></span>
<span><span class="co">#&gt; Corresponding epoch: Infancy, Infancy, Toddlerhood, Toddlerhood, Childhood</span></span>
<span><span class="co">#&gt; Variable and their encodings:</span></span>
<span><span class="co">#&gt;             var     type time</span></span>
<span><span class="co">#&gt;        ESETA1.6 exposure    6</span></span>
<span><span class="co">#&gt;       ESETA1.15 exposure   15</span></span>
<span><span class="co">#&gt;       ESETA1.24 exposure   24</span></span>
<span><span class="co">#&gt;       ESETA1.35 exposure   35</span></span>
<span><span class="co">#&gt;       ESETA1.58 exposure   58</span></span>
<span><span class="co">#&gt;     SAAmylase.6  tv_conf    6</span></span>
<span><span class="co">#&gt;    SAAmylase.15  tv_conf   15</span></span>
<span><span class="co">#&gt;    SAAmylase.24  tv_conf   24</span></span>
<span><span class="co">#&gt;           MDI.6  tv_conf    6</span></span>
<span><span class="co">#&gt;          MDI.15  tv_conf   15</span></span>
<span><span class="co">#&gt;        RHasSO.6  tv_conf    6</span></span>
<span><span class="co">#&gt;       RHasSO.15  tv_conf   15</span></span>
<span><span class="co">#&gt;       RHasSO.24  tv_conf   24</span></span>
<span><span class="co">#&gt;       RHasSO.35  tv_conf   35</span></span>
<span><span class="co">#&gt;    WndNbrhood.6  tv_conf    6</span></span>
<span><span class="co">#&gt;   WndNbrhood.24  tv_conf   24</span></span>
<span><span class="co">#&gt;   WndNbrhood.35  tv_conf   35</span></span>
<span><span class="co">#&gt;       IBRAttn.6  tv_conf    6</span></span>
<span><span class="co">#&gt;      IBRAttn.15  tv_conf   15</span></span>
<span><span class="co">#&gt;      IBRAttn.24  tv_conf   24</span></span>
<span><span class="co">#&gt;        B18Raw.6  tv_conf    6</span></span>
<span><span class="co">#&gt;       B18Raw.15  tv_conf   15</span></span>
<span><span class="co">#&gt;       B18Raw.24  tv_conf   24</span></span>
<span><span class="co">#&gt;      HOMEETA1.6  tv_conf    6</span></span>
<span><span class="co">#&gt;     HOMEETA1.15  tv_conf   15</span></span>
<span><span class="co">#&gt;     HOMEETA1.24  tv_conf   24</span></span>
<span><span class="co">#&gt;     HOMEETA1.35  tv_conf   35</span></span>
<span><span class="co">#&gt;    InRatioCor.6  tv_conf    6</span></span>
<span><span class="co">#&gt;   InRatioCor.15  tv_conf   15</span></span>
<span><span class="co">#&gt;   InRatioCor.24  tv_conf   24</span></span>
<span><span class="co">#&gt;   InRatioCor.35  tv_conf   35</span></span>
<span><span class="co">#&gt;         CORTB.6  tv_conf    6</span></span>
<span><span class="co">#&gt;        CORTB.15  tv_conf   15</span></span>
<span><span class="co">#&gt;        CORTB.24  tv_conf   24</span></span>
<span><span class="co">#&gt;     EARS_TJo.24  tv_conf   24</span></span>
<span><span class="co">#&gt;     EARS_TJo.35  tv_conf   35</span></span>
<span><span class="co">#&gt;     LESMnPos.24  tv_conf   24</span></span>
<span><span class="co">#&gt;     LESMnPos.35  tv_conf   35</span></span>
<span><span class="co">#&gt;     LESMnNeg.24  tv_conf   24</span></span>
<span><span class="co">#&gt;     LESMnNeg.35  tv_conf   35</span></span>
<span><span class="co">#&gt;   StrDif_Tot.35  tv_conf   35</span></span>
<span><span class="co">#&gt;       fscore.35  tv_conf   35</span></span>
<span><span class="co">#&gt;           state  ti_conf   -1</span></span>
<span><span class="co">#&gt;     BioDadInHH2  ti_conf   -1</span></span>
<span><span class="co">#&gt;          PmAge2  ti_conf   -1</span></span>
<span><span class="co">#&gt;         PmBlac2  ti_conf   -1</span></span>
<span><span class="co">#&gt;         TcBlac2  ti_conf   -1</span></span>
<span><span class="co">#&gt;         PmMrSt2  ti_conf   -1</span></span>
<span><span class="co">#&gt;           PmEd2  ti_conf   -1</span></span>
<span><span class="co">#&gt;        KFASTScr  ti_conf   -1</span></span>
<span><span class="co">#&gt;        RMomAgeU  ti_conf   -1</span></span>
<span><span class="co">#&gt;         RHealth  ti_conf   -1</span></span>
<span><span class="co">#&gt;        HomeOwnd  ti_conf   -1</span></span>
<span><span class="co">#&gt;         SWghtLB  ti_conf   -1</span></span>
<span><span class="co">#&gt;        SurpPreg  ti_conf   -1</span></span>
<span><span class="co">#&gt;        SmokTotl  ti_conf   -1</span></span>
<span><span class="co">#&gt;        DrnkFreq  ti_conf   -1</span></span>
<span><span class="co">#&gt;     peri_health  ti_conf   -1</span></span>
<span><span class="co">#&gt;  caregiv_health  ti_conf   -1</span></span>
<span><span class="co">#&gt;      gov_assist  ti_conf   -1</span></span></code></pre></div>
</div>
<p><br></p>
</section><section class="level3"><h4 id="p4-5--recommended-inspect-exposure-histories-and-data">P4.5. Recommended: Inspect Exposure Histories and Data<a class="anchor" aria-label="anchor" href="#p4-5--recommended-inspect-exposure-histories-and-data"></a>
</h4>
<p>For all users, we highly recommend use of the helper <code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/inspectData.html" class="external-link">inspectData()</a></code> function (with the a complete dataset in long or wide format or imputed data in the case of missingness) to summarize exposure, outcome, and confounders and inspect the sample distribution among exposure histories. Based on any user-specified exposure epochs and high and low quantile values (for continuous exposures), this function outputs a table showing the sample distribution across all histories.</p>
<p>We strongly suggest visually inspecting this table and revising the designation of epochs and/or high and low quantile values (for continuous exposures) until each history contains a reasonable number of participants. While there is no gold standard required number per history cell, users should guard against extrapolation beyond the scope of the data. For example, in our data, when using 75th and 25th percentile expemplar cutoffs, there were histories that represented less than two cases and thus we re-evaluated our cutoffs. Users may wish to revise any epoch designation and high and low exemplar cutoff values, where applicable. The function conducts summaries and history distribution inspection for each imputed dataset if imputed data are supplied.</p>
<p>The required inputs for <code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/inspectData.html" class="external-link">inspectData()</a></code> are: complete data (as a data frame in wide or long format, a list of imputed data frames in wide format, or a mids object), exposure (e.g., “variable”), and outcome (e.g., “variable.t”). If the exposure is continuously distributed, the user is required to supply to <code>hi_lo_cut</code> values demarcating high and low levels.</p>
<p>Optional inputs are a home directory (if <code>save.out</code> = TRUE), epochs, high/low exemplar cutoff values for continuous exposures, and specification of reference and comparison histories.</p>
<p>The helper <code><a href="https://rdrr.io/pkg/devMSMsHelpers/man/inspectData.html" class="external-link">inspectData()</a></code> function outputs the following files into the home directory: a correlation plot of all variables in the dataset, tables of exposure and outcome descriptive statistics, and two summary tables of the confounders considered at each time point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/devMSMsHelpers/man/inspectData.html" class="external-link">inspectData</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>            obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>            outcome <span class="op">=</span> <span class="va">outcome</span>, </span>
<span>            hi_lo_cut <span class="op">=</span> <span class="va">hi_lo_cut</span>,</span>
<span>            reference <span class="op">=</span> <span class="va">reference</span>, </span>
<span>            comparison <span class="op">=</span> <span class="va">comparison</span>, </span>
<span>            verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Imputation 1</span></span>
<span><span class="co">#&gt; USER ALERT: Out of the total of 1292 individuals in the sample, below is the distribution of the 333 (26%) individuals that fall into 2 user-selected exposure histories (out of the 27 total) created from 30th and 60th percentile values for low and high levels of exposure-epoch Infancy, Toddlerhood, Childhood.</span></span>
<span><span class="co">#&gt; USER ALERT: Please inspect the distribution of the sample across the following exposure histories and ensure there is sufficient spread to avoid extrapolation and low precision:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +---------------+-----+</span></span>
<span><span class="co">#&gt; | epoch_history | n   |</span></span>
<span><span class="co">#&gt; +===============+=====+</span></span>
<span><span class="co">#&gt; | h-h-h         | 214 |</span></span>
<span><span class="co">#&gt; +---------------+-----+</span></span>
<span><span class="co">#&gt; | l-l-l         | 119 |</span></span>
<span><span class="co">#&gt; +---------------+-----+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of user-selected exposure histories based on exposure main effects Infancy, Toddlerhood, Childhood:</span></span>
<span><span class="co">#&gt; USER ALERT: Below are the 55 variables spanning 32 unique domains that will be treated as confounding variables for the relation between ESETA1 and StrDif_Tot.58.</span></span>
<span><span class="co">#&gt; Please inspect this list carefully. It should include all time-varying covariates, time invariant covariates, as well as lagged levels of exposure and outcome variables if they were collected at time points earlier than the outcome time point.</span></span>
<span><span class="co">#&gt;  [1] "B18Raw.15"      "B18Raw.24"      "B18Raw.6"       "BioDadInHH2"   </span></span>
<span><span class="co">#&gt;  [5] "caregiv_health" "CORTB.15"       "CORTB.24"       "CORTB.6"       </span></span>
<span><span class="co">#&gt;  [9] "DrnkFreq"       "EARS_TJo.24"    "EARS_TJo.35"    "fscore.35"     </span></span>
<span><span class="co">#&gt; [13] "gov_assist"     "HOMEETA1.15"    "HOMEETA1.24"    "HOMEETA1.35"   </span></span>
<span><span class="co">#&gt; [17] "HOMEETA1.6"     "HomeOwnd"       "IBRAttn.15"     "IBRAttn.24"    </span></span>
<span><span class="co">#&gt; [21] "IBRAttn.6"      "InRatioCor.15"  "InRatioCor.24"  "InRatioCor.35" </span></span>
<span><span class="co">#&gt; [25] "InRatioCor.6"   "KFASTScr"       "LESMnNeg.24"    "LESMnNeg.35"   </span></span>
<span><span class="co">#&gt; [29] "LESMnPos.24"    "LESMnPos.35"    "MDI.15"         "MDI.6"         </span></span>
<span><span class="co">#&gt; [33] "peri_health"    "PmAge2"         "PmBlac2"        "PmEd2"         </span></span>
<span><span class="co">#&gt; [37] "PmMrSt2"        "RHasSO.15"      "RHasSO.24"      "RHasSO.35"     </span></span>
<span><span class="co">#&gt; [41] "RHasSO.6"       "RHealth"        "RMomAgeU"       "SAAmylase.15"  </span></span>
<span><span class="co">#&gt; [45] "SAAmylase.24"   "SAAmylase.6"    "SmokTotl"       "state"         </span></span>
<span><span class="co">#&gt; [49] "StrDif_Tot.35"  "SurpPreg"       "SWghtLB"        "TcBlac2"       </span></span>
<span><span class="co">#&gt; [53] "WndNbrhood.24"  "WndNbrhood.35"  "WndNbrhood.6"  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following variables are designated as numeric: </span></span>
<span><span class="co">#&gt; [1] "ALI_Le.35, CORTB.15, CORTB.24, CORTB.6, ESETA1.15, ESETA1.24, ESETA1.35, ESETA1.58, ESETA1.6, fscore.35, fscore.58, HOMEETA1.15, HOMEETA1.24, HOMEETA1.35, HOMEETA1.58, HOMEETA1.6, IBRAttn.15, IBRAttn.24, IBRAttn.6, ID, InRatioCor.15, InRatioCor.24, InRatioCor.35, InRatioCor.58, InRatioCor.6, LESMnNeg.24, LESMnNeg.35, LESMnPos.24, LESMnPos.35, PmAge2, SAAmylase.15, SAAmylase.24, SAAmylase.6, StrDif_Tot.35, StrDif_Tot.58, WndNbrhood.24, WndNbrhood.35, WndNbrhood.58, WndNbrhood.6, ESETA1.Childhood, ESETA1.Infancy, ESETA1.Toddlerhood"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following variables are designated as factors: </span></span>
<span><span class="co">#&gt; [1] "BioDadInHH2, DrnkFreq, HomeOwnd, PmBlac2, PmMrSt2, RHasSO.15, RHasSO.24, RHasSO.35, RHasSO.58, RHasSO.6, RHealth, SmokTotl, state, SurpPreg, TcBlac2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Other variable types</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |               |variable       |type    |</span></span>
<span><span class="co">#&gt; |:--------------|:--------------|:-------|</span></span>
<span><span class="co">#&gt; |B18Raw.15      |B18Raw.15      |integer |</span></span>
<span><span class="co">#&gt; |B18Raw.24      |B18Raw.24      |integer |</span></span>
<span><span class="co">#&gt; |B18Raw.58      |B18Raw.58      |integer |</span></span>
<span><span class="co">#&gt; |B18Raw.6       |B18Raw.6       |integer |</span></span>
<span><span class="co">#&gt; |caregiv_health |caregiv_health |integer |</span></span>
<span><span class="co">#&gt; |EARS_TJo.24    |EARS_TJo.24    |integer |</span></span>
<span><span class="co">#&gt; |EARS_TJo.35    |EARS_TJo.35    |integer |</span></span>
<span><span class="co">#&gt; |gov_assist     |gov_assist     |integer |</span></span>
<span><span class="co">#&gt; |KFASTScr       |KFASTScr       |integer |</span></span>
<span><span class="co">#&gt; |MDI.15         |MDI.15         |integer |</span></span>
<span><span class="co">#&gt; |MDI.6          |MDI.6          |integer |</span></span>
<span><span class="co">#&gt; |peri_health    |peri_health    |integer |</span></span>
<span><span class="co">#&gt; |PmEd2          |PmEd2          |integer |</span></span>
<span><span class="co">#&gt; |RMomAgeU       |RMomAgeU       |integer |</span></span>
<span><span class="co">#&gt; |SWghtLB        |SWghtLB        |integer |</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; &lt;table class="kable_wrapper"&gt;</span></span>
<span><span class="co">#&gt; &lt;caption&gt;Summary of ESETA1 Information&lt;/caption&gt;</span></span>
<span><span class="co">#&gt; &lt;tbody&gt;</span></span>
<span><span class="co">#&gt;   &lt;tr&gt;</span></span>
<span><span class="co">#&gt;    &lt;td&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |   |   ESETA1.6     |  ESETA1.15     |  ESETA1.24     |  ESETA1.35      |  ESETA1.58      |</span></span>
<span><span class="co">#&gt; |:--|:---------------|:---------------|:---------------|:----------------|:----------------|</span></span>
<span><span class="co">#&gt; |   |Min.   :-2.8090 |Min.   :-3.1010 |Min.   :-2.8580 |Min.   :-3.24100 |Min.   :-2.47800 |</span></span>
<span><span class="co">#&gt; |   |1st Qu.:-0.4193 |1st Qu.:-0.4153 |1st Qu.:-0.4665 |1st Qu.:-0.57050 |1st Qu.:-0.51100 |</span></span>
<span><span class="co">#&gt; |   |Median : 0.3030 |Median : 0.2165 |Median : 0.1445 |Median : 0.07300 |Median : 0.05650 |</span></span>
<span><span class="co">#&gt; |   |Mean   : 0.2765 |Mean   : 0.2115 |Mean   : 0.1154 |Mean   : 0.08565 |Mean   : 0.07673 |</span></span>
<span><span class="co">#&gt; |   |3rd Qu.: 0.9000 |3rd Qu.: 0.8620 |3rd Qu.: 0.7258 |3rd Qu.: 0.74075 |3rd Qu.: 0.71425 |</span></span>
<span><span class="co">#&gt; |   |Max.   : 4.0350 |Max.   : 3.4740 |Max.   : 3.2840 |Max.   : 3.01400 |Max.   : 3.17300 |</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  &lt;/td&gt;</span></span>
<span><span class="co">#&gt;   &lt;/tr&gt;</span></span>
<span><span class="co">#&gt; &lt;/tbody&gt;</span></span>
<span><span class="co">#&gt; &lt;/table&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of StrDif_Tot.58 Information</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |   Min.| X1st.Qu.| Median|      Mean| X3rd.Qu.|  Max.|</span></span>
<span><span class="co">#&gt; |------:|--------:|------:|---------:|--------:|-----:|</span></span>
<span><span class="co">#&gt; | -0.497|    0.297|   0.48| 0.4897314|    0.689| 1.448|</span></span>
<span><span class="co">#&gt; Imputation 2</span></span>
<span><span class="co">#&gt; USER ALERT: Out of the total of 1292 individuals in the sample, below is the distribution of the 333 (26%) individuals that fall into 2 user-selected exposure histories (out of the 27 total) created from 30th and 60th percentile values for low and high levels of exposure-epoch Infancy, Toddlerhood, Childhood.</span></span>
<span><span class="co">#&gt; USER ALERT: Please inspect the distribution of the sample across the following exposure histories and ensure there is sufficient spread to avoid extrapolation and low precision:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +---------------+-----+</span></span>
<span><span class="co">#&gt; | epoch_history | n   |</span></span>
<span><span class="co">#&gt; +===============+=====+</span></span>
<span><span class="co">#&gt; | h-h-h         | 218 |</span></span>
<span><span class="co">#&gt; +---------------+-----+</span></span>
<span><span class="co">#&gt; | l-l-l         | 115 |</span></span>
<span><span class="co">#&gt; +---------------+-----+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of user-selected exposure histories based on exposure main effects Infancy, Toddlerhood, Childhood:</span></span>
<span><span class="co">#&gt; USER ALERT: Below are the 55 variables spanning 32 unique domains that will be treated as confounding variables for the relation between ESETA1 and StrDif_Tot.58.</span></span>
<span><span class="co">#&gt; Please inspect this list carefully. It should include all time-varying covariates, time invariant covariates, as well as lagged levels of exposure and outcome variables if they were collected at time points earlier than the outcome time point.</span></span>
<span><span class="co">#&gt;  [1] "B18Raw.15"      "B18Raw.24"      "B18Raw.6"       "BioDadInHH2"   </span></span>
<span><span class="co">#&gt;  [5] "caregiv_health" "CORTB.15"       "CORTB.24"       "CORTB.6"       </span></span>
<span><span class="co">#&gt;  [9] "DrnkFreq"       "EARS_TJo.24"    "EARS_TJo.35"    "fscore.35"     </span></span>
<span><span class="co">#&gt; [13] "gov_assist"     "HOMEETA1.15"    "HOMEETA1.24"    "HOMEETA1.35"   </span></span>
<span><span class="co">#&gt; [17] "HOMEETA1.6"     "HomeOwnd"       "IBRAttn.15"     "IBRAttn.24"    </span></span>
<span><span class="co">#&gt; [21] "IBRAttn.6"      "InRatioCor.15"  "InRatioCor.24"  "InRatioCor.35" </span></span>
<span><span class="co">#&gt; [25] "InRatioCor.6"   "KFASTScr"       "LESMnNeg.24"    "LESMnNeg.35"   </span></span>
<span><span class="co">#&gt; [29] "LESMnPos.24"    "LESMnPos.35"    "MDI.15"         "MDI.6"         </span></span>
<span><span class="co">#&gt; [33] "peri_health"    "PmAge2"         "PmBlac2"        "PmEd2"         </span></span>
<span><span class="co">#&gt; [37] "PmMrSt2"        "RHasSO.15"      "RHasSO.24"      "RHasSO.35"     </span></span>
<span><span class="co">#&gt; [41] "RHasSO.6"       "RHealth"        "RMomAgeU"       "SAAmylase.15"  </span></span>
<span><span class="co">#&gt; [45] "SAAmylase.24"   "SAAmylase.6"    "SmokTotl"       "state"         </span></span>
<span><span class="co">#&gt; [49] "StrDif_Tot.35"  "SurpPreg"       "SWghtLB"        "TcBlac2"       </span></span>
<span><span class="co">#&gt; [53] "WndNbrhood.24"  "WndNbrhood.35"  "WndNbrhood.6"  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following variables are designated as numeric: </span></span>
<span><span class="co">#&gt; [1] "ALI_Le.35, CORTB.15, CORTB.24, CORTB.6, ESETA1.15, ESETA1.24, ESETA1.35, ESETA1.58, ESETA1.6, fscore.35, fscore.58, HOMEETA1.15, HOMEETA1.24, HOMEETA1.35, HOMEETA1.58, HOMEETA1.6, IBRAttn.15, IBRAttn.24, IBRAttn.6, ID, InRatioCor.15, InRatioCor.24, InRatioCor.35, InRatioCor.58, InRatioCor.6, LESMnNeg.24, LESMnNeg.35, LESMnPos.24, LESMnPos.35, PmAge2, SAAmylase.15, SAAmylase.24, SAAmylase.6, StrDif_Tot.35, StrDif_Tot.58, WndNbrhood.24, WndNbrhood.35, WndNbrhood.58, WndNbrhood.6, ESETA1.Childhood, ESETA1.Infancy, ESETA1.Toddlerhood"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following variables are designated as factors: </span></span>
<span><span class="co">#&gt; [1] "BioDadInHH2, DrnkFreq, HomeOwnd, PmBlac2, PmMrSt2, RHasSO.15, RHasSO.24, RHasSO.35, RHasSO.58, RHasSO.6, RHealth, SmokTotl, state, SurpPreg, TcBlac2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Other variable types</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |               |variable       |type    |</span></span>
<span><span class="co">#&gt; |:--------------|:--------------|:-------|</span></span>
<span><span class="co">#&gt; |B18Raw.15      |B18Raw.15      |integer |</span></span>
<span><span class="co">#&gt; |B18Raw.24      |B18Raw.24      |integer |</span></span>
<span><span class="co">#&gt; |B18Raw.58      |B18Raw.58      |integer |</span></span>
<span><span class="co">#&gt; |B18Raw.6       |B18Raw.6       |integer |</span></span>
<span><span class="co">#&gt; |caregiv_health |caregiv_health |integer |</span></span>
<span><span class="co">#&gt; |EARS_TJo.24    |EARS_TJo.24    |integer |</span></span>
<span><span class="co">#&gt; |EARS_TJo.35    |EARS_TJo.35    |integer |</span></span>
<span><span class="co">#&gt; |gov_assist     |gov_assist     |integer |</span></span>
<span><span class="co">#&gt; |KFASTScr       |KFASTScr       |integer |</span></span>
<span><span class="co">#&gt; |MDI.15         |MDI.15         |integer |</span></span>
<span><span class="co">#&gt; |MDI.6          |MDI.6          |integer |</span></span>
<span><span class="co">#&gt; |peri_health    |peri_health    |integer |</span></span>
<span><span class="co">#&gt; |PmEd2          |PmEd2          |integer |</span></span>
<span><span class="co">#&gt; |RMomAgeU       |RMomAgeU       |integer |</span></span>
<span><span class="co">#&gt; |SWghtLB        |SWghtLB        |integer |</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; &lt;table class="kable_wrapper"&gt;</span></span>
<span><span class="co">#&gt; &lt;caption&gt;Summary of ESETA1 Information&lt;/caption&gt;</span></span>
<span><span class="co">#&gt; &lt;tbody&gt;</span></span>
<span><span class="co">#&gt;   &lt;tr&gt;</span></span>
<span><span class="co">#&gt;    &lt;td&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |   |   ESETA1.6     |  ESETA1.15     |  ESETA1.24     |  ESETA1.35      |  ESETA1.58      |</span></span>
<span><span class="co">#&gt; |:--|:---------------|:---------------|:---------------|:----------------|:----------------|</span></span>
<span><span class="co">#&gt; |   |Min.   :-2.8090 |Min.   :-3.1010 |Min.   :-2.8580 |Min.   :-3.24100 |Min.   :-2.47800 |</span></span>
<span><span class="co">#&gt; |   |1st Qu.:-0.3245 |1st Qu.:-0.4133 |1st Qu.:-0.5020 |1st Qu.:-0.56900 |1st Qu.:-0.53350 |</span></span>
<span><span class="co">#&gt; |   |Median : 0.3440 |Median : 0.2215 |Median : 0.1160 |Median : 0.07400 |Median : 0.08300 |</span></span>
<span><span class="co">#&gt; |   |Mean   : 0.3201 |Mean   : 0.2022 |Mean   : 0.1229 |Mean   : 0.08662 |Mean   : 0.07948 |</span></span>
<span><span class="co">#&gt; |   |3rd Qu.: 0.9423 |3rd Qu.: 0.8482 |3rd Qu.: 0.7380 |3rd Qu.: 0.74625 |3rd Qu.: 0.70550 |</span></span>
<span><span class="co">#&gt; |   |Max.   : 4.0350 |Max.   : 3.4740 |Max.   : 3.2840 |Max.   : 3.01400 |Max.   : 3.17300 |</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  &lt;/td&gt;</span></span>
<span><span class="co">#&gt;   &lt;/tr&gt;</span></span>
<span><span class="co">#&gt; &lt;/tbody&gt;</span></span>
<span><span class="co">#&gt; &lt;/table&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of StrDif_Tot.58 Information</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |   Min.| X1st.Qu.| Median|     Mean| X3rd.Qu.|  Max.|</span></span>
<span><span class="co">#&gt; |------:|--------:|------:|--------:|--------:|-----:|</span></span>
<span><span class="co">#&gt; | -0.497|  0.29675|  0.472| 0.489219|  0.69325| 1.448|</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
<p>Here, we see summaries of the data types as well as reasonable cell counts in each of our specified histories, for each imputed dataset.</p>
<p><br><br></p>
</section></section></section><section class="section level2"><h2 id="phase-1-confounder-adjustment">PHASE 1: Confounder Adjustment<a class="anchor" aria-label="anchor" href="#phase-1-confounder-adjustment"></a>
</h2>
<p>The goal of this first phase is to minimize the associations between confounders and exposure using IPTW balancing weights. We strongly advise the user to carefully inspect each weights formula to ensure weights are created and evaluated appropriately at each step.<br><br></p>
<section class="level2"><h3 id="step-1-create-full-weights-formulas-conduct-pre-balance-checking">STEP 1: Create Full Weights Formulas &amp; Conduct Pre-Balance Checking<a class="anchor" aria-label="anchor" href="#step-1-create-full-weights-formulas-conduct-pre-balance-checking"></a>
</h3>
<section class="level3"><h4 id="a--create-full-weights-formulas-at-each-exposure-time-point">1a. Create Full Weights Formulas at each Exposure Time Point<a class="anchor" aria-label="anchor" href="#a--create-full-weights-formulas-at-each-exposure-time-point"></a>
</h4>
<p>We first create comprehensive, full weights formulas relating exposure to confounders at each time point using the <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function (<code>type</code> = “full”). This step creates full formulas containing all measured confounding variables at each exposure time point, including all time-invariant confounders and lagged time-varying confounders. The code automatically excludes time-varying confounders at the contemporaneous time point given that they cannot be decisively differentiated from mediators which should not be balanced on (Thoemmes &amp; Ong, 2016), although this can be modified by the user if they have strong reason to believe a concurrent variable is truly a confounder (see below).</p>
<p>If the user wishes to specify any interactions between confounders in the weights formulas, they need to manually create them in the data before listing them here. Keep in mind that any interactions that include factor variables will be decomposed into interactions at each factor level.</p>
<p>The required input to create full weights formulas using the <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function are: MSM object (e.g., “obj”) and setting <code>type</code> = “full”.</p>
<p>Optional inputs to create full weights formulas using the <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function are as follows.</p>
<p>The user may specify a list of custom formulas by specifying to <code>custom</code> a list of formulas, one for each exposure time point (e.g., “exposure.time ~ variable.time + variable +…”) in formula format. We recommend first running the <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function without custom formulas (<code>custom</code> = NULL) and using the output as a model of the required format for custom formulas. The <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function will automatically check custom formulas to ensure that there is a correctly formatted formula for each exposure time point with exposure as the dependent variable. However, the user is responsible for ensuring the custom formulas contain the appropriate confounders for the formula type they are generating.</p>
<p>Please see the <a href="https://istallworthy.github.io/devMSMs/articles/Customize_Balancing_Formulas.html">Customize Weights Formulas vignette</a> for more detail on how to customize formulas.</p>
<p>We chose not to create custom formulas and instead use <code><a href="../reference/createFormulas.html">createFormulas()</a></code> to make them automatically in this example.</p>
<p>We first create full formulas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"full"</span></span>
<span></span>
<span><span class="va">full_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createFormulas.html">createFormulas</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                type <span class="op">=</span> <span class="va">type</span>, </span>
<span>                                save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The function returns a list of formulas, one for each exposure time point. We inspect them below. Each full formula contains all time invariant confounders as well as all lagged time-varying confounders at each time point. This inspection is an important step, to verify that all appropriate confounders are present in each formula.</p>
<p>We inspect the formulas below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">full_formulas</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; At time point 6, the full formula for ESETA1.6 is: </span></span>
<span><span class="co">#&gt; ESETA1.6 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; At time point 15, the full formula for ESETA1.15 is: </span></span>
<span><span class="co">#&gt; ESETA1.15 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.6 + MDI.6 + RHasSO.6 + WndNbrhood.6 + IBRAttn.6 + B18Raw.6 + HOMEETA1.6 + InRatioCor.6 + CORTB.6 + ESETA1.6</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; At time point 24, the full formula for ESETA1.24 is: </span></span>
<span><span class="co">#&gt; ESETA1.24 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.6 + SAAmylase.15 + MDI.6 + MDI.15 + RHasSO.6 + RHasSO.15 + WndNbrhood.6 + IBRAttn.6 + IBRAttn.15 + B18Raw.6 + B18Raw.15 + HOMEETA1.6 + HOMEETA1.15 + InRatioCor.6 + InRatioCor.15 + CORTB.6 + CORTB.15 + ESETA1.6 + ESETA1.15</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; At time point 35, the full formula for ESETA1.35 is: </span></span>
<span><span class="co">#&gt; ESETA1.35 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.6 + SAAmylase.15 + SAAmylase.24 + MDI.6 + MDI.15 + RHasSO.6 + RHasSO.15 + RHasSO.24 + WndNbrhood.6 + WndNbrhood.24 + IBRAttn.6 + IBRAttn.15 + IBRAttn.24 + B18Raw.6 + B18Raw.15 + B18Raw.24 + HOMEETA1.6 + HOMEETA1.15 + HOMEETA1.24 + InRatioCor.6 + InRatioCor.15 + InRatioCor.24 + CORTB.6 +      CORTB.15 + CORTB.24 + EARS_TJo.24 + LESMnPos.24 + LESMnNeg.24 + ESETA1.6 + ESETA1.15 + ESETA1.24</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; At time point 58, the full formula for ESETA1.58 is: </span></span>
<span><span class="co">#&gt; ESETA1.58 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.6 + SAAmylase.15 + SAAmylase.24 + MDI.6 + MDI.15 + RHasSO.6 + RHasSO.15 + RHasSO.24 + RHasSO.35 + WndNbrhood.6 + WndNbrhood.24 + WndNbrhood.35 + IBRAttn.6 + IBRAttn.15 + IBRAttn.24 + B18Raw.6 + B18Raw.15 + B18Raw.24 + HOMEETA1.6 + HOMEETA1.15 + HOMEETA1.24 + HOMEETA1.35 + InRatioCor.6 +      InRatioCor.15 + InRatioCor.24 + InRatioCor.35 + CORTB.6 + CORTB.15 + CORTB.24 + EARS_TJo.24 + EARS_TJo.35 + LESMnPos.24 + LESMnPos.35 + LESMnNeg.24 + LESMnNeg.35 + StrDif_Tot.35 + fscore.35 + ESETA1.6 + ESETA1.15 + ESETA1.24 + ESETA1.35</span></span></code></pre></div>
</div>
<p><br></p>
</section><section class="level3"><h4 id="b--conduct-exploratory-pre-balance-assessment">1b. Conduct Exploratory Pre-Balance Assessment<a class="anchor" aria-label="anchor" href="#b--conduct-exploratory-pre-balance-assessment"></a>
</h4>
<p>The next step examines the initial imbalance, or how strongly exposure relates to each confounder at each time point, for all measured confounders prior to weighting using the <code><a href="../reference/assessBalance.html">assessBalance()</a></code> function. This function draws on the <code>calcBalStats()</code> function (see the Assessing Balance for Time-Varying Exposure section in the accompanying manuscript).<br></p>
<p>The <code><a href="../reference/assessBalance.html">assessBalance()</a></code> function outputs balance statistics (correlations for continuous exposures and standardized mean differences for binary exposures) relating exposure at each time point to confounders in a table as well as in plots. This function also provides summary balance statistics averaging across all time points (and imputed datasets if they are supplied).</p>
<p>The required inputs for using the <code><a href="../reference/assessBalance.html">assessBalance()</a></code> function to conduct pre-balance testing are: data (data frame, a mids object, or a list of imputed datasets as dataframes in wide format) and an MSM object (e.g., “obj”). Please see the <em>Assessing Balance for Time-Varying Exposures</em> vignette for more detail on how this function calculates balance.</p>
<p>The optional inputs are as follows.</p>
<p>The user may specify <code>balance_thresh</code>, or a threshold(s) for determining confounder balance, in one of two ways.</p>
<ul>
<li><p>First, they can provide a single number value (0-1) for the absolute value of the standardized balance statistic (either the correlation for continuous exposures or standardized group mean difference for binary exposures) for exposure and confounders below which confounders are considered balanced, and above which they are considered imbalanced (default is 0.1; Stuart, 2010).</p></li>
<li><p>Second, users may make an a priori assertion that some confounders are more important than others based on theory and existing research. In this case, they can provide two numbers that represent the balance thresholds for important and less important confounders, respectively. If the user supplies two balance thresholds, they must also supply a list of important confounders (time-varying: “variable.t”, time invariant: “variable”) to the <code>imp_conf</code> field. The balance threshold specification should be kept consistent throughout the use of this workflow.</p></li>
</ul>
<p>Below, as recommended, we provide two balancing thresholds and identify income and parent education as important confounders in the relation between economic strain and behavior problems.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">balance_thresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">imp_conf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"InRatioCor.6"</span>, <span class="st">"InRatioCor.15"</span>, <span class="st">"InRatioCor.24"</span>, <span class="st">"InRatioCor.35"</span>, </span>
<span>              <span class="st">"PmEd2"</span><span class="op">)</span> </span></code></pre></div>
</div>
<p>We create prebalance statistics below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prebalance_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                  data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                  balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>, </span>
<span>                                  imp_conf <span class="op">=</span> <span class="va">imp_conf</span>, </span>
<span>                                  save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The function returns a list (one entry per imputed dataset, when applicable), that contains a table for each exposure time point. The able contains all confounders for that time point, each with an associated standardized balance statistics relating confounder to exposure at that time point, user-supplied balance threshold, and a binary indicator of whether the confounder is balanced.</p>
<p>As shown below, we can print, summarize, and plot several versions of the balance statistics with the option to supply <code>save.out</code> to save viewed output to the home directory.</p>
<p>Each of these functions takes an optional <code>t</code> field to view balance statistics for any one of your exposure time points. <code>t</code> takes an integer value from 1 to the total number of time points. If it is not specified, the output is shown for all exposure time points.</p>
<p>With imputed data, each of these functions takes an option <code>i</code> field that can be used to view balance for any one imputed data set. If it is not specified, output is shown averaged across the absolute values of the balance statistics of the imputed datasets. It can be useful to average across imputed datasets to get an overall sense of balance. For non-imputed data, do not specify <code>i</code>.</p>
<p>We can view prebalance statistics for any single imputed dataset (e.g., first imputed dataset), using the <code>i</code> field. Note that we supply <code>t</code> as integers 1 through however number of time points at which exposure is measured. For example, my first time point measures ESETA1 at 6 months which corresponds to <code>t</code> = 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">prebalance_stats</span>, </span>
<span>      i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      t <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | exposure | covariate      | std_bal_stats | bal_thresh | balanced |</span></span>
<span><span class="co">#&gt; +==========+================+===============+============+==========+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | state_1        | 0.13324       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | BioDadInHH2_1  | -0.13865      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | PmAge2         | -0.06481      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | PmBlac2_1      | 0.17598       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | TcBlac2_1      | 0.20129       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | PmMrSt2_1      | -0.14101      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | PmEd2          | -0.23888      | 0.05       | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | KFASTScr       | -0.18058      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RMomAgeU       | -0.11428      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_1      | -0.08223      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_2      | -0.01624      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_3      | 0.07892       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_4      | 0.10536       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_5      | 0.0588        | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | HomeOwnd_1     | -0.13681      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | HomeOwnd_2     | -0.0364       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | HomeOwnd_3     | 0.09405       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | HomeOwnd_4     | 0.15808       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SWghtLB        | -0.09514      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SurpPreg_1     | 0.10405       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SmokTotl_1     | 0.00731       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SmokTotl_2     | 0.04693       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SmokTotl_3     | 0.04867       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | DrnkFreq_1     | -0.0182       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | DrnkFreq_2     | 0.02272       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | peri_health    | 0.02042       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | caregiv_health | 0.14314       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | gov_assist     | 0.31012       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Balance Stats for Exposure Time 1 for imputation (1)</span></span></code></pre></div>
</div>
<p>Or, we can view prebalance statistics averaged across imputed data sets at different time points by not specifying <code>i</code>. This can also be used to view balance statistics when the data are not imputed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">prebalance_stats</span>, </span>
<span>      t <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | exposure | covariate      | std_bal_stats | bal_thresh | balanced |</span></span>
<span><span class="co">#&gt; +==========+================+===============+============+==========+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | state_1        | 0.12646       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | BioDadInHH2_1  | -0.13395      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | PmAge2         | -0.0525       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | PmBlac2_1      | 0.18314       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | TcBlac2_1      | 0.20776       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | PmMrSt2_1      | -0.12948      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | PmEd2          | -0.23456      | 0.05       | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | KFASTScr       | -0.17153      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RMomAgeU       | -0.10139      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_1      | -0.07479      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_2      | -0.01536      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_3      | 0.07441       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_4      | 0.10334       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | RHealth_5      | 0.05769       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | HomeOwnd_1     | -0.13942      | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | HomeOwnd_2     | -0.04196      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | HomeOwnd_3     | 0.10162       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | HomeOwnd_4     | 0.15135       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SWghtLB        | -0.09639      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SurpPreg_1     | 0.10475       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SmokTotl_1     | 0.0135        | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SmokTotl_2     | 0.04304       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | SmokTotl_3     | 0.05533       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | DrnkFreq_1     | -0.00539      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | DrnkFreq_2     | 0.01557       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | peri_health    | 0.02454       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | caregiv_health | 0.15074       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6 | gov_assist     | 0.30943       | 0.1        | 0        |</span></span>
<span><span class="co">#&gt; +----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Balance Stats for Exposure Time 1 Averaging Across Imputed Datasets</span></span></code></pre></div>
</div>
<p>We can also summarize the <code><a href="../reference/assessBalance.html">assessBalance()</a></code> output to view the average remaining relation between confounders and exposure as well as a summary table showing the total number of imbalanced confounders at each exposure time point. We can view this in one imputed dataset or averaged across them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">prebalance_stats</span>, </span>
<span>        i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: For imputation 1: As shown below, 55 out of 241 (22.8%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.13 (max: 0.31):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 14                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 11                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 11                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 11                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 8                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates for imputation 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">prebalance_stats</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputated datasets: As shown below, 60 out of 241 (24.9%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.13 (max: 0.31):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 15                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 12                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 11                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 14                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 8                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaged Across Imputed Datasets</span></span></code></pre></div>
</div>
<p>Averaging across imputed datasets, we see that xx confounders are imbalanced with respect to the economic strain exposure and their respective balance threshold.</p>
<p>Lastly, we can plot a balance summary at one or more time points, from one imputed dataset or averaged across them. The dotted red lines denote our balance thresholds and the points colored and labeled in red denote confounders that are imbalanced in relation to their respective balance thresholds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prebalance_stats</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     t <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prebalance_stats</span>, </span>
<span>     t <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-22-2.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br><br>
The love plots depict the standardized associations between confounder and exposure at each exposure time point, with the vertical red dashed lines indicating balance thresholds. Imbalanced confounders are shown in red with variable name labels.</p>
<p><br><br></p>
</section></section><section class="level2"><h3 id="step-2-create-simplified-weights-formulas-determine-optimal-weighting-method">STEP 2: Create Simplified Weights Formulas &amp; Determine Optimal Weighting Method<a class="anchor" aria-label="anchor" href="#step-2-create-simplified-weights-formulas-determine-optimal-weighting-method"></a>
</h3>
<p>The goal of this second step is to create shortened, more parsimonious weights formulas for determining the optimal IPTW weighting method that most successfully reduces imbalance in the data.<br><br></p>
<section class="level3"><h4 id="a--create-simplified-weights-formulas">2a. Create Simplified Weights Formulas<a class="anchor" aria-label="anchor" href="#a--create-simplified-weights-formulas"></a>
</h4>
<p>First, we create shorter, more parsimonious weights formulas relating exposure to confounders at each time point using the <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function (<code>type</code> = “short”). For each exposure time point, these formulas contain all time invariant confounders as well as time-varying confounders only at the <em>t</em>-1 lag. The logic here is that balancing on confounders at the most recent prior time point (<em>t</em>-1 only) may achieve balance on levels at more distal time points, given the stability of many confounders over time. Importantly, we will empirically assess and relax this assumption if needed at subsequent steps (Steps 3a-b).</p>
<p>The required input to create shortened weights formulas using the <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function are: a MSM object (e.g., ‘obj’) and setting <code>type</code> = “short”.</p>
<p>In addition to the optional input outlined in Step 1a, the user also has the option to specify in <code>keep_conf</code>, a list of any time-varying confounders (e.g., “variable.t”) to always retain as lagged confounders in these shortened formulas. The user may use this argument to retain specific time-varying confounders that would otherwise be excluded at this step if they occur at lags greater than <em>t</em>-1 for each formula.</p>
<p>We create short formulas below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"short"</span> </span>
<span></span>
<span><span class="va">short_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createFormulas.html">createFormulas</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                 type <span class="op">=</span> <span class="va">type</span>, </span>
<span>                                 save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span> </span></code></pre></div>
</div>
<p>We again get a list with entries containing a formula for each exposure time point.</p>
<p>And then inspect them to make sure they contain only time-varying covariates at a lag of one prior to the exposure time point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">short_formulas</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; At time point 6, the short formula for ESETA1.6 is: </span></span>
<span><span class="co">#&gt; ESETA1.6 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; At time point 15, the short formula for ESETA1.15 is: </span></span>
<span><span class="co">#&gt; ESETA1.15 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.6 + MDI.6 + RHasSO.6 + WndNbrhood.6 + IBRAttn.6 + B18Raw.6 + HOMEETA1.6 + InRatioCor.6 + CORTB.6 + ESETA1.6</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; At time point 24, the short formula for ESETA1.24 is: </span></span>
<span><span class="co">#&gt; ESETA1.24 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.15 + MDI.15 + RHasSO.15 + IBRAttn.15 + B18Raw.15 + HOMEETA1.15 + InRatioCor.15 + CORTB.15 + ESETA1.15</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; At time point 35, the short formula for ESETA1.35 is: </span></span>
<span><span class="co">#&gt; ESETA1.35 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.24 + RHasSO.24 + WndNbrhood.24 + IBRAttn.24 + B18Raw.24 + HOMEETA1.24 + InRatioCor.24 + CORTB.24 + EARS_TJo.24 + LESMnPos.24 + LESMnNeg.24 + ESETA1.24</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; At time point 58, the short formula for ESETA1.58 is: </span></span>
<span><span class="co">#&gt; ESETA1.58 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + RHasSO.35 + WndNbrhood.35 + HOMEETA1.35 + InRatioCor.35 + EARS_TJo.35 + LESMnPos.35 + LESMnNeg.35 + StrDif_Tot.35 + fscore.35 + ESETA1.35</span></span></code></pre></div>
</div>
<p>These formulas are considerably shorter than the full formulas. For instance, at the 58-month exposure time point, the formula contains all time invariant confounders and only time-varying confounders at the 35-month time point.</p>
<p><br></p>
</section><section class="level3"><h4 id="b--create-iptw-balancing-weights-using-multiple-weighting-methods">2b. Create IPTW Balancing Weights Using Multiple Weighting Methods<a class="anchor" aria-label="anchor" href="#b--create-iptw-balancing-weights-using-multiple-weighting-methods"></a>
</h4>
<p>Having created shorter, simplified weights formulas, we now create the first round of IPTW balancing weights (Thoemmes &amp; Ong, 2016) using the <code><a href="../reference/createWeights.html">createWeights()</a></code> function, the shortened weights formulas, and all available weighting methods. The function calls the <code>weightitMSM()</code> function from the <em>WeightIt</em> package (Greifer, 2024) that uses the time-specific formulas to create weights at each time point before automatically multiplying them together to create one weight per person. Weights are stabilized, as recommended (Cole &amp; Hernan, 2008; Thoemmes &amp; Ong, 2016), and distributions can be saved for inspection.</p>
<p>The required inputs for using the <code><a href="../reference/createWeights.html">createWeights()</a></code> function to create the initial around of IPTW balancing weights are: an MSM object (e.g, ‘obj’), complete data (data frame, mids object, or a list of imputed datasets as dataframes in wide format), and the short formulas (see Step 2a).</p>
<p>We specify the short formulas below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formulas</span> <span class="op">&lt;-</span> <span class="va">short_formulas</span></span></code></pre></div>
</div>
<p>The optional inputs are as follows.</p>
<p>For <code>method</code>, provide one of the following methods for calculating balancing weights using <code>weightitMSM()</code> from the methods that have been validated for longitudinal exposures: “cbps” (Covariate Balancing Propensity Score weighting), “gbm” (generalized boosted model), “glm” (generalized linear model; default), or “super” (SuperLearner via the <em>SuperLearner</em> package; Polley et al., 2013). More information can be found in the <a href="(https://ngreifer.github.io/WeightIt/reference/weightitMSM.html" class="external-link"><em>WeightIt</em> documentation</a>.</p>
<p>We begin with specifying CBPS as a weighting method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"cbps"</span></span></code></pre></div>
</div>
<p>The <code><a href="../reference/createWeights.html">createWeights()</a></code> function can also take any number of additional arguments that are accapted by the <code>weightitMSM()</code> function (e.g., ‘criterion’, distribution’, ‘SL.library’). The package defaults correspond to the <em>weightIt</em> defaults. If the user selects the SuperLearner (“super”) method, the default super learner libraries (‘SL.library’) are “SL.glm” and “SL.glm.interaction” but an alternative library can be entered as an input to the <code>createWeights</code> function. For binary exposures, the “cbps” method allows you to specify <code>estimand</code> as either ATE, ATT, or ATC. With “glm”, “super”, and “bart” you can specify ATE, ATT, ATC, ATO, ATM, or ATOS. With “gbm”, you can specify ATE, ATT, ATC, ATO, or ATM. The default estimand for binary exposures is ATE. We advise the interested user to review the <a href="(https://ngreifer.github.io/WeightIt/reference/weightitMSM.html" class="external-link"><em>WeightIt</em> documentation</a> for more information about the additional optional arguments available for each of the weighting methods. Users have the option to specify <code>verbose</code> = TRUE to view information about weights creation.</p>
<p>The function returns a list of weights objects each in the form of WeightItMSM output (with an entry for each imputed dataset when appropriate). <br></p>
<section class="level4"><h5 id="cbps">CBPS<a class="anchor" aria-label="anchor" href="#cbps"></a>
</h5>
<p>Below, we create IPTW weights using the default CBPS method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights.cbps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWeights.html">createWeights</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                             data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                             method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                             formulas <span class="op">=</span> <span class="va">formulas</span>,</span>
<span>                             verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; initial  value 0.903706 </span></span>
<span><span class="co">#&gt; iter  10 value 0.248548</span></span>
<span><span class="co">#&gt; iter  20 value 0.222840</span></span>
<span><span class="co">#&gt; iter  30 value 0.209527</span></span>
<span><span class="co">#&gt; iter  40 value 0.169216</span></span>
<span><span class="co">#&gt; iter  50 value 0.141001</span></span>
<span><span class="co">#&gt; iter  60 value 0.139547</span></span>
<span><span class="co">#&gt; iter  70 value 0.139440</span></span>
<span><span class="co">#&gt; iter  80 value 0.139430</span></span>
<span><span class="co">#&gt; iter  90 value 0.139430</span></span>
<span><span class="co">#&gt; final  value 0.139430 </span></span>
<span><span class="co">#&gt; converged</span></span>
<span><span class="co">#&gt; initial  value 0.585184 </span></span>
<span><span class="co">#&gt; iter  10 value 0.241866</span></span>
<span><span class="co">#&gt; iter  20 value 0.144858</span></span>
<span><span class="co">#&gt; iter  30 value 0.108653</span></span>
<span><span class="co">#&gt; iter  40 value 0.099077</span></span>
<span><span class="co">#&gt; iter  50 value 0.098009</span></span>
<span><span class="co">#&gt; iter  60 value 0.097791</span></span>
<span><span class="co">#&gt; iter  70 value 0.097759</span></span>
<span><span class="co">#&gt; iter  80 value 0.097753</span></span>
<span><span class="co">#&gt; iter  90 value 0.097752</span></span>
<span><span class="co">#&gt; iter 100 value 0.097752</span></span>
<span><span class="co">#&gt; iter 110 value 0.097752</span></span>
<span><span class="co">#&gt; final  value 0.097752 </span></span>
<span><span class="co">#&gt; converged</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `cbps` weighting method, the median weight value is 0.77 (SD = 1.18; range = 0-9).</span></span></code></pre></div>
</div>
<p>These take a while to run. Note that if you save the weights (by supplying <code>save.out</code> = TRUE or a custom file name to <code><a href="../reference/createWeights.html">createWeights()</a></code> and a home directory to <code>initMWM()</code>), the function outputs the file path to use for reading in the weights for future use. This can be useful given that some weighting methods can take a long time to run, especially for imputed datasets.</p>
<p>If we had previously saved out CBPS weights, we could read them in instead of re-creating them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># weights.cbps &lt;- readRDS('file_path_to_saved_weights.rds')</span></span></code></pre></div>
</div>
<p>Given that a separate set of weights is created for each imputed dataset, we conduct our inspections on each imputed dataset.</p>
<p>First, we view the basic statistics of the CBPS weights for a given imputed dataset. Here, we note a median weight value of 0.77 (SD= 1.18) but with a fairly extensive range of 0 - 9.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">weights.cbps</span>, </span>
<span>      i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `cbps` weighting method, the median weight value is 0.77 (SD = 1.18; range = 0-9).</span></span></code></pre></div>
</div>
<p>Next, we look inside the output to summarize the weighting process (drawing on the summary method from <em>weightIt</em>), for any given imputed dataset (we chose the first one here).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.cbps</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Summary of weights</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight ranges:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Min                                  Max</span></span>
<span><span class="co">#&gt; all   0 |---------------------------| 8.5133</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Units with the 5 most extreme weights:</span></span>
<span><span class="co">#&gt;                                        </span></span>
<span><span class="co">#&gt;        1246   1145    294    697    919</span></span>
<span><span class="co">#&gt;  all 7.4584 7.6788 7.9896 8.2035 8.5133</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight statistics:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Coef of Var   MAD Entropy # Zeros</span></span>
<span><span class="co">#&gt; all       1.066 0.725   0.443       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Effective Sample Sizes:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.  </span></span>
<span><span class="co">#&gt; Weighted    605.05</span></span></code></pre></div>
</div>
<p>This summary also provides the effective sample size, or the sample size that results from applying the weights to the original sample size, for each time point. Weighting can often result is an effective or weighted sample size that is smaller than the orignal sample size and is something to keep in mind when evaluating weighting methods. In this example, we see that our original 1,292 sample is reduced to 605 upon weighting with the CBPS method.</p>
<p>We then view a distribution plot of the weights for any one imputed dataset. The user has the option to supply <code>save.out</code> to save plots to the home directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">weights.cbps</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-31-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As shown above, the distribution has a heavy right tail (typical of real-world data). The right tail of the distribution represents individuals who experienced statistically unexpected levels of exposure given their levels of confounders.</p>
<p>We then create and inspect IPTW balancing weights using all other available methods in order to evaluate and compare their performance in subsequent steps. Here, we summarize and plot averaging across all imputed datasets in order to get a sense for their overall performance. Example inspections are for the first imputed dataset.<br><br></p>
</section><section class="level4"><h5 id="glm">GLM<a class="anchor" aria-label="anchor" href="#glm"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"glm"</span></span>
<span></span>
<span><span class="va">weights.glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWeights.html">createWeights</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                             data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                             method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                             formulas <span class="op">=</span> <span class="va">formulas</span>, </span>
<span>                             save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">weights.glm</span>, </span>
<span>      i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `glm` weighting method, the median weight value is 1.27 (SD = 10.03; range = 0-271).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.glm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Summary of weights</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight ranges:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Min                                    Max</span></span>
<span><span class="co">#&gt; all   0 |---------------------------| 271.3462</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Units with the 5 most extreme weights:</span></span>
<span><span class="co">#&gt;                                               </span></span>
<span><span class="co">#&gt;         1030     475     697     1145      591</span></span>
<span><span class="co">#&gt;  all 52.1877 58.3054 63.4626 178.9983 271.3462</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight statistics:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Coef of Var  MAD Entropy # Zeros</span></span>
<span><span class="co">#&gt; all       3.824 0.96   1.144       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Effective Sample Sizes:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.  </span></span>
<span><span class="co">#&gt; Weighted     82.74</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">weights.glm</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-32-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As shown above, the GLM method produces a higher median of 1.27 and a much greater range of weights.</p>
<p><br></p>
</section><section class="level4"><h5 id="gbm">GBM<a class="anchor" aria-label="anchor" href="#gbm"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"gbm"</span></span>
<span></span>
<span><span class="va">weights.gbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWeights.html">createWeights</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>,</span>
<span>                             data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                             method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                             formulas <span class="op">=</span> <span class="va">formulas</span>,</span>
<span>                             save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">weights.gbm</span>,</span>
<span>      i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `gbm` weighting method, the median weight value is 1.26 (SD = 8.18; range = 0-216).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.gbm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Summary of weights</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight ranges:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Min                                    Max</span></span>
<span><span class="co">#&gt; all   0 |---------------------------| 216.1534</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Units with the 5 most extreme weights:</span></span>
<span><span class="co">#&gt;                                              </span></span>
<span><span class="co">#&gt;          342      30     475    1145       36</span></span>
<span><span class="co">#&gt;  all 43.0076 43.1447 55.5631 150.016 216.1534</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight statistics:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Coef of Var   MAD Entropy # Zeros</span></span>
<span><span class="co">#&gt; all       3.383 0.916   1.016       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Effective Sample Sizes:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.  </span></span>
<span><span class="co">#&gt; Weighted    103.87</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">weights.gbm</span>,</span>
<span>     i <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-33-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The GBM method produces a similar mean as GLM and a similarly large range (0-216).</p>
<p><br></p>
</section><section class="level4"><h5 id="bart">Bart<a class="anchor" aria-label="anchor" href="#bart"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"bart"</span></span>
<span></span>
<span><span class="va">weights.bart</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWeights.html">createWeights</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                             data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                             method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                             formulas <span class="op">=</span> <span class="va">formulas</span>, </span>
<span>                             save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">weights.bart</span>, </span>
<span>      i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `bart` weighting method, the median weight value is 1.25 (SD = 10.51; range = 0-287).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.bart</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Summary of weights</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight ranges:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Min                                    Max</span></span>
<span><span class="co">#&gt; all   0 |---------------------------| 287.3248</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Units with the 5 most extreme weights:</span></span>
<span><span class="co">#&gt;                                               </span></span>
<span><span class="co">#&gt;          79    1235      475      591     1145</span></span>
<span><span class="co">#&gt;  all 42.841 73.1125 117.9498 159.0904 287.3248</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight statistics:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Coef of Var  MAD Entropy # Zeros</span></span>
<span><span class="co">#&gt; all       4.012 0.97   1.202       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Effective Sample Sizes:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.  </span></span>
<span><span class="co">#&gt; Weighted     75.64</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">weights.bart</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-34-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bart method has a similar median and an even larger range (0-945).</p>
<p><br></p>
</section><section class="level4"><h5 id="super">Super<a class="anchor" aria-label="anchor" href="#super"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"super"</span></span>
<span></span>
<span><span class="va">weights.super</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWeights.html">createWeights</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                             data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                             method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                             formulas <span class="op">=</span> <span class="va">formulas</span>, </span>
<span>                             save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nnls</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning: glm.fit: algorithm did not converge</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">weights.super</span>, </span>
<span>      i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `super` weighting method, the median weight value is 1.27 (SD = 9.99; range = 0-270).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.super</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Summary of weights</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight ranges:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Min                                    Max</span></span>
<span><span class="co">#&gt; all   0 |---------------------------| 270.2898</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Units with the 5 most extreme weights:</span></span>
<span><span class="co">#&gt;                                               </span></span>
<span><span class="co">#&gt;         1030     475     697     1145      591</span></span>
<span><span class="co">#&gt;  all 52.0314 58.1278 63.2379 178.3232 270.2898</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight statistics:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Coef of Var   MAD Entropy # Zeros</span></span>
<span><span class="co">#&gt; all       3.817 0.959   1.141       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Effective Sample Sizes:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.  </span></span>
<span><span class="co">#&gt; Weighted     83.06</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">weights.super</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-35-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The super method produces a similar median and a range of 0-270.</p>
<p><br></p>
</section></section><section class="level3"><h4 id="c--assess-all-weighting-methods-to-determine-optimal-method">2c. Assess All Weighting Methods to Determine Optimal Method<a class="anchor" aria-label="anchor" href="#c--assess-all-weighting-methods-to-determine-optimal-method"></a>
</h4>
<p>Next, we evaluate how well the weights created using each of the different weighting methods reduced imbalance using the <code><a href="../reference/assessBalance.html">assessBalance()</a></code> function. This function calls the <code>calcBalStats()</code> function using the short formulas and specifies that the balance statistics should be calculated using the IPTW weights supplied.</p>
<p>The required inputs for using the <code><a href="../reference/assessBalance.html">assessBalance()</a></code> function to assess balance for the first round of IPTW weights are: complete data (data frame, mids object, or a list of imputed datasets as dataframes in wide format), a MSM object (e.g., ‘obj’), and the weights that were just created.</p>
<p>The optional inputs are described in Step 1b.</p>
<p>The <code><a href="../reference/assessBalance.html">assessBalance()</a></code> function returns a data frame (or list) of balance statistics, balance thresholds, and binary balanced tag (1 = balanced, 0 = imbalanced) for each confounder relevant to each exposure time point. The function outputs balance statistics (correlations for continuous exposures and standardized mean differences for binary exposures) relating exposure at each time point to confounders in a table as well as in plots. This function also provides summary balance statistics averaging across all time points (and imputed datasets if they are supplied).</p>
<p>We retain the same optional important confounders (<code>imp_conf</code>) and balance threshold (<code>balance_thresh</code>) as we specified earlier.<br><br></p>
<section class="level4"><h5 id="cbps-1">CBPS<a class="anchor" aria-label="anchor" href="#cbps-1"></a>
</h5>
<p>We first assess balance for the CBPS weighting method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">weights.cbps</span> </span>
<span></span>
<span><span class="va">balance_stats.cbps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                    obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                    weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>                                    imp_conf <span class="op">=</span> <span class="va">imp_conf</span>, </span>
<span>                                    balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>,</span>
<span>                                    save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The function returns a list of balance statistics for each expsoure time point, with one entry per imputed dataset (where applicable).</p>
<p>For assessing balance using imputed data, we can average across imputed datasets to view an overall summary of the performance method. We can also examine each imputed dataset individually.</p>
<p>We summarize the CBPS balance statistics across imputed datasets and examine balance for the first imputed dataset. The user has the option to supply <code>save.out</code> to save printed output to the home directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">balance_stats.cbps</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `cbps` weighting method: As shown below, 2 out of 241 (0.8%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.06 (max: 0.07):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 2                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `cbps`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">balance_stats.cbps</span>, </span>
<span>        i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; No covariates remain imbalaned for imputation 1 using `cbps` weighting method.</span></span>
<span><span class="co">#&gt; USER ALERT: For imputation 1 using `cbps` weighting method: As shown below, 0 out of 241 (0.0%) covariates across time points remain imbalanced:</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates for imputation 1 using `cbps`</span></span></code></pre></div>
</div>
<p>Averaging across imputed datasets, we find only 2 imbalanced confounders remaining (both at the 35-month exposure time point) out of 241, with a median remaining correlation of 0.06 and a maximum of 0.07.</p>
<p>We can then visualize the imbalance with love plots, averaging across imputed datasets, for each exposure time point (with the first time point shown here). We can also plot balance for any given imputed datset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">balance_stats.cbps</span>, </span>
<span>     t <span class="op">=</span> <span class="fl">4</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-38-1.png" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">balance_stats.cbps</span>, </span>
<span>     t <span class="op">=</span> <span class="fl">4</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-38-2.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see that income at 6 and 15 months remains imbalanced at the 4th (35-month) time point.</p>
<p>We can then inspect the balance statistics for each confounder in relation to exposure at all time points or each one individually, either averaging across imputed datasets or for any one individually. The user has the option to supply <code>save.out</code> to save printed output to the home directory. Below, we show an example of balance statistics for the first time point, averaged across imputed datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">balance_stats.cbps</span>, </span>
<span>      t <span class="op">=</span> <span class="fl">4</span>, </span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | exposure  | covariate      | std_bal_stats | bal_thresh | balanced |</span></span>
<span><span class="co">#&gt; +===========+================+===============+============+==========+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | state_1        | 0.015983      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | BioDadInHH2_1  | -0.021684     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | PmAge2         | -0.007495     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | PmBlac2_1      | 0.010394      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | TcBlac2_1      | 0.016379      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | PmMrSt2_1      | -0.001098     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | PmEd2          | -0.038985     | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | KFASTScr       | -0.025092     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RMomAgeU       | -0.013873     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_1      | 0.01822       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_2      | -0.023165     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_3      | -0.000151     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_4      | 0.024033      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_5      | 0.005528      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HomeOwnd_1     | -0.025162     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HomeOwnd_2     | 0.032238      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HomeOwnd_3     | -0.019883     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HomeOwnd_4     | 0.012453      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SWghtLB        | -0.003066     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SurpPreg_1     | 0.026666      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SmokTotl_1     | -0.012978     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SmokTotl_2     | -0.013427     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SmokTotl_3     | 0.009223      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | DrnkFreq_1     | -0.022527     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | DrnkFreq_2     | 0.009097      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | peri_health    | 0.001458      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | caregiv_health | -0.005178     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | gov_assist     | 0.031891      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SAAmylase.6    | -0.026253     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SAAmylase.15   | -0.016326     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SAAmylase.24   | 0.010026      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | MDI.6          | -0.018593     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | MDI.15         | 0.025268      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHasSO.6_1     | 0.018598      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHasSO.15_1    | 0.037178      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHasSO.24_1    | 0.013187      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | WndNbrhood.6   | -0.03217      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | WndNbrhood.24  | -0.022858     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | IBRAttn.6      | -0.060497     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | IBRAttn.15     | -0.017497     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | IBRAttn.24     | 0.005987      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | B18Raw.6       | 0.040266      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | B18Raw.15      | 0.026635      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | B18Raw.24      | 0.01303       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HOMEETA1.6     | -0.057376     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HOMEETA1.15    | -0.020653     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HOMEETA1.24    | -0.006641     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | InRatioCor.6   | -0.065029     | 0.05       | 0        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | InRatioCor.15  | -0.060949     | 0.05       | 0        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | InRatioCor.24  | -0.036797     | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | CORTB.6        | 0.038284      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | CORTB.15       | 0.009567      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | CORTB.24       | 0.026607      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | EARS_TJo.24    | -0.01226      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | LESMnPos.24    | -0.010644     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | LESMnNeg.24    | 0.008181      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | ESETA1.6       | 0.084496      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | ESETA1.15      | 0.077512      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | ESETA1.24      | 0.020474      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Balance Stats for Exposure Time 4 Averaging Across Imputed Datasets</span></span></code></pre></div>
</div>
<p>As shown above, the two remaining imbalanced confounders are related to exposure with correlation values of 0.065 and 0.061.</p>
<p>Below, we assess balance for each weighting method before comparing them all.</p>
<p><br></p>
</section><section class="level4"><h5 id="glm-1">GLM<a class="anchor" aria-label="anchor" href="#glm-1"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">weights.glm</span></span>
<span></span>
<span><span class="va">balance_stats.glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                    obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                    weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>                                    imp_conf <span class="op">=</span> <span class="va">imp_conf</span>, </span>
<span>                                    balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>,</span>
<span>                                    save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level4"><h5 id="gbm-1">GBM<a class="anchor" aria-label="anchor" href="#gbm-1"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">weights.gbm</span></span>
<span></span>
<span><span class="va">balance_stats.gbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                                   obj <span class="op">=</span> <span class="va">obj</span>,</span>
<span>                                   weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>                                   imp_conf <span class="op">=</span> <span class="va">imp_conf</span>,</span>
<span>                                   balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>,</span>
<span>                                   save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level4"><h5 id="bart-1">Bart<a class="anchor" aria-label="anchor" href="#bart-1"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span>  <span class="va">weights.bart</span></span>
<span></span>
<span><span class="va">balance_stats.bart</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                     obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                     weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>                                     imp_conf <span class="op">=</span> <span class="va">imp_conf</span>, </span>
<span>                                     balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>,</span>
<span>                                     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level4"><h5 id="super-1">Super<a class="anchor" aria-label="anchor" href="#super-1"></a>
</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">weights.super</span> </span>
<span></span>
<span><span class="va">balance_stats.super</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                     obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                     weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>                                     imp_conf <span class="op">=</span> <span class="va">imp_conf</span>, </span>
<span>                                     balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>,</span>
<span>                                     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
<p><br></p>
<p>From these summaries, we identify the optimal weighting method for a dataset, or the one that yields the best confounder balance. To do this, we can consider several criteria. We note that there exist no gold-standard, hard and fast rules for identifying optimal balance (especially when using imputed data). However, we can draw from the following guidance:</p>
<ul>
<li>Fewest imbalanced confounders remaining relative to the user-specified balance threshold(s) (from summary output);</li>
<li>Lowest median absolute balance statistic, across all confounders and time points, reflecting the best overall attenuation of confounding (from summary output);</li>
<li>Lowest maximum absolute balance statistic, across all confounders and time points (and imputed datasets, where applicable), indicating weakest remaining relation between exposure and confounder for the least balanced confounder (from summary output);<br>
</li>
<li>Reasonable effective sample size following weighting (for all imputed datasets, where applicable), indicating reasonable power to detect effects (from <em>WeightIt</em> summary output). <br> For the first three, we examine summaries for each of the weighting methods.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">balance_stats.cbps</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `cbps` weighting method: As shown below, 2 out of 241 (0.8%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.06 (max: 0.07):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 2                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `cbps`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">balance_stats.glm</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `glm` weighting method: As shown below, 31 out of 241 (12.9%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.13 (max: 0.29):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 7                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 18                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 2                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 2                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 2                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `glm`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">balance_stats.gbm</span>,</span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `gbm` weighting method: As shown below, 27 out of 241 (11.2%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.12 (max: 0.22):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 7                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 3                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 10                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 5                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 2                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `gbm`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">balance_stats.bart</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `bart` weighting method: As shown below, 20 out of 241 (8.3%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.12 (max: 0.20):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 3                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 13                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 4                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `bart`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">balance_stats.super</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `super` weighting method: As shown below, 31 out of 241 (12.9%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.13 (max: 0.29):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 7                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 18                         |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 2                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 2                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 2                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `super`</span></span></code></pre></div>
</div>
<p>From this, we find that the CBPS method has the fewest imbalanced confounders (with only 2), lowest median balance statistic, and lowest max balance statistic.</p>
<p>To examine the fourth criterion, we use the <em>WeightIt</em> summary method to examine effective sample sizes (“Weighted”) compared to the orignal sample size (“Unweighted”) across weighting methods. We do this just for the first imputed dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.cbps</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">#&gt; $effective.sample.size</span></span>
<span><span class="co">#&gt;                Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.0000</span></span>
<span><span class="co">#&gt; Weighted    605.0464</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.glm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">#&gt; $effective.sample.size</span></span>
<span><span class="co">#&gt;                 Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.00000</span></span>
<span><span class="co">#&gt; Weighted     82.74434</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.gbm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">#&gt; $effective.sample.size</span></span>
<span><span class="co">#&gt;                Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.0000</span></span>
<span><span class="co">#&gt; Weighted    103.8726</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.bart</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">#&gt; $effective.sample.size</span></span>
<span><span class="co">#&gt;                 Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.00000</span></span>
<span><span class="co">#&gt; Weighted     75.63941</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">weights.super</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">#&gt; $effective.sample.size</span></span>
<span><span class="co">#&gt;                 Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.00000</span></span>
<span><span class="co">#&gt; Weighted     83.05617</span></span></code></pre></div>
</div>
<p>From this, we also find that the CBPS method yields the highest effective sample size of 605.</p>
<p>From these inspections, we identify the best performing weighting method as CBPS.</p>
<p><br><br></p>
</section></section></section><section class="level2"><h3 id="step-3-create-updated-formulas-re-specify-weights-using-optimal-weighting-method">STEP 3: Create Updated Formulas &amp; Re-Specify Weights Using Optimal Weighting Method<a class="anchor" aria-label="anchor" href="#step-3-create-updated-formulas-re-specify-weights-using-optimal-weighting-method"></a>
</h3>
<p>The goal of this next step is to more closely inspect the balance reults of the best-performing weights created by the shortened weights formulas, and add to the shortened formulas any time-varying confounders at lags &gt; <em>t</em>-1 that were not successfully balanced, to create a final round of weights.<br><br></p>
<section class="level3"><h4 id="a--examine-balance-of-optimal-weighting-method">3a. Examine Balance of Optimal Weighting Method<a class="anchor" aria-label="anchor" href="#a--examine-balance-of-optimal-weighting-method"></a>
</h4>
<p>We next inspect the balance produced by the weights created in the previous step with the best-performing weights method (i.e., using the SuperLearner method). Here, we revisit our assumption that balancing on the most proximal time-varying confounders (<em>t</em>-1) confers balance for those same confounders at more distal prior time points (<em>t</em>- 1+).</p>
<p>We more closely inspect the balance of the CBPS weights, averaged across imputed datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">balance_stats.cbps</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | exposure  | covariate      | std_bal_stats | bal_thresh | balanced |</span></span>
<span><span class="co">#&gt; +===========+================+===============+============+==========+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | state_1        | 0.0056034     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | BioDadInHH2_1  | -0.0010151    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | PmAge2         | -0.0014034    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | PmBlac2_1      | 0.0057004     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | TcBlac2_1      | 0.00573       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | PmMrSt2_1      | -0.0031771    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | PmEd2          | -0.012679     | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | KFASTScr       | -0.0123214    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | RMomAgeU       | -0.0050025    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | RHealth_1      | -0.0058629    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | RHealth_2      | -0.0005754    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | RHealth_3      | 0.0023589     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | RHealth_4      | 0.0062374     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | RHealth_5      | 0.0165892     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | HomeOwnd_1     | -0.0015333    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | HomeOwnd_2     | -0.0004356    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | HomeOwnd_3     | 0.0036856     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | HomeOwnd_4     | 0.0058472     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | SWghtLB        | -0.0076898    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | SurpPreg_1     | 0.0027969     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | SmokTotl_1     | 0.0041912     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | SmokTotl_2     | -0.0021743    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | SmokTotl_3     | 0.0126991     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | DrnkFreq_1     | -0.0056466    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | DrnkFreq_2     | 0.0062906     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | peri_health    | 0.0018215     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | caregiv_health | 0.0063082     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | gov_assist     | 0.0142943     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | state_1        | 0.0093952     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | BioDadInHH2_1  | -0.0060927    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmAge2         | -0.00208      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmBlac2_1      | 0.0078337     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | TcBlac2_1      | 0.0047278     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmMrSt2_1      | -0.0034177    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmEd2          | -0.0143275    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | KFASTScr       | -0.0059542    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RMomAgeU       | -0.0017358    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_1      | -0.0033082    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_2      | -0.0021582    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_3      | 0.0017789     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_4      | 0.0109618     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_5      | -0.0110065    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_1     | -0.0072874    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_2     | -0.0014992    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_3     | 0.0027983     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_4     | 0.0084701     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SWghtLB        | -0.0013946    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SurpPreg_1     | 0.0011901     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SmokTotl_1     | 0.001428      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SmokTotl_2     | 0.0056477     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SmokTotl_3     | -0.0058619    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | DrnkFreq_1     | 0.0061578     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | DrnkFreq_2     | -0.0064726    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | peri_health    | -0.0016954    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | caregiv_health | 0.0067329     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | gov_assist     | 0.0086291     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SAAmylase.6    | 0.0031313     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | MDI.6          | -0.0008863    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHasSO.6_1     | 0.0072931     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | WndNbrhood.6   | -0.0053117    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | IBRAttn.6      | -0.0030081    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | B18Raw.6       | 0.02019       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HOMEETA1.6     | -0.0133514    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | InRatioCor.6   | -0.0212591    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | CORTB.6        | -0.0004608    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | ESETA1.6       | 0.0190614     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | state_1        | 0.0178119     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | BioDadInHH2_1  | -0.0113769    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | PmAge2         | -0.0025452    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | PmBlac2_1      | 0.0137188     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | TcBlac2_1      | 0.0194866     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | PmMrSt2_1      | 0.0056731     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | PmEd2          | -0.008877     | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | KFASTScr       | 0.0027329     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | RMomAgeU       | -0.0066139    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | RHealth_1      | -0.0024307    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | RHealth_2      | 0.0132036     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | RHealth_3      | -0.013124     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | RHealth_4      | -0.0077852    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | RHealth_5      | 0.0232195     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | HomeOwnd_1     | -0.0102631    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | HomeOwnd_2     | -0.0164389    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | HomeOwnd_3     | 0.0056524     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | HomeOwnd_4     | 0.0031887     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | SWghtLB        | 0.0047102     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | SurpPreg_1     | 0.0027554     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | SmokTotl_1     | 0.0039061     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | SmokTotl_2     | -0.0184713    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | SmokTotl_3     | 0.0039587     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | DrnkFreq_1     | 0.0133344     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | DrnkFreq_2     | -0.0110409    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | peri_health    | -0.0071191    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | caregiv_health | -0.0052549    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | gov_assist     | -0.0017467    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | SAAmylase.6    | 0.0159657     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | SAAmylase.15   | 0.0082811     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | MDI.6          | 0.0094745     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | MDI.15         | -0.0034084    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | RHasSO.6_1     | -0.0140331    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | RHasSO.15_1    | -0.0012295    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | WndNbrhood.6   | 0.0017792     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | IBRAttn.6      | -0.0016471    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | IBRAttn.15     | -0.0003454    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | B18Raw.6       | 0.0822367     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | B18Raw.15      | 0.0005681     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | HOMEETA1.6     | 0.0113974     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | HOMEETA1.15    | 0.0067258     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | InRatioCor.6   | -0.0374551    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | InRatioCor.15  | 0.0098437     | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | CORTB.6        | 0.0563054     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | CORTB.15       | -0.0059241    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | ESETA1.6       | 0.0273455     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | ESETA1.15      | 0.0061277     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | state_1        | 0.015983      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | BioDadInHH2_1  | -0.0216841    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | PmAge2         | -0.0074949    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | PmBlac2_1      | 0.0103938     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | TcBlac2_1      | 0.0163794     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | PmMrSt2_1      | -0.0010981    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | PmEd2          | -0.0389853    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | KFASTScr       | -0.0250923    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RMomAgeU       | -0.0138732    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_1      | 0.0182195     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_2      | -0.0231651    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_3      | -0.0001514    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_4      | 0.0240332     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHealth_5      | 0.0055284     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HomeOwnd_1     | -0.0251616    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HomeOwnd_2     | 0.0322383     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HomeOwnd_3     | -0.0198834    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HomeOwnd_4     | 0.0124529     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SWghtLB        | -0.0030659    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SurpPreg_1     | 0.026666      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SmokTotl_1     | -0.0129779    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SmokTotl_2     | -0.0134266    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SmokTotl_3     | 0.0092228     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | DrnkFreq_1     | -0.0225274    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | DrnkFreq_2     | 0.0090973     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | peri_health    | 0.001458      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | caregiv_health | -0.0051784    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | gov_assist     | 0.0318911     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SAAmylase.6    | -0.0262531    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SAAmylase.15   | -0.0163258    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | SAAmylase.24   | 0.0100263     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | MDI.6          | -0.0185927    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | MDI.15         | 0.0252676     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHasSO.6_1     | 0.018598      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHasSO.15_1    | 0.0371781     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | RHasSO.24_1    | 0.0131865     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | WndNbrhood.6   | -0.03217      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | WndNbrhood.24  | -0.0228582    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | IBRAttn.6      | -0.0604965    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | IBRAttn.15     | -0.0174968    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | IBRAttn.24     | 0.005987      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | B18Raw.6       | 0.0402662     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | B18Raw.15      | 0.0266352     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | B18Raw.24      | 0.0130299     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HOMEETA1.6     | -0.0573762    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HOMEETA1.15    | -0.0206531    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | HOMEETA1.24    | -0.0066412    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | InRatioCor.6   | -0.0650289    | 0.05       | 0        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | InRatioCor.15  | -0.0609493    | 0.05       | 0        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | InRatioCor.24  | -0.0367975    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | CORTB.6        | 0.038284      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | CORTB.15       | 0.0095669     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | CORTB.24       | 0.0266071     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | EARS_TJo.24    | -0.0122597    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | LESMnPos.24    | -0.0106442    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | LESMnNeg.24    | 0.0081812     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | ESETA1.6       | 0.0844961     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | ESETA1.15      | 0.0775119     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | ESETA1.24      | 0.0204745     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | state_1        | 0.017319      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | BioDadInHH2_1  | -0.0293291    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | PmAge2         | -0.0022436    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | PmBlac2_1      | 0.0167731     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | TcBlac2_1      | 0.0285214     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | PmMrSt2_1      | -0.0308847    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | PmEd2          | -0.0058347    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | KFASTScr       | 0.0001798     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RMomAgeU       | 0.0200846     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RHealth_1      | -0.0046501    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RHealth_2      | 0.0058814     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RHealth_3      | 0.0057158     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RHealth_4      | -0.0099908    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RHealth_5      | -0.0018157    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | HomeOwnd_1     | -0.0129381    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | HomeOwnd_2     | 0.008825      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | HomeOwnd_3     | 0.0293163     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | HomeOwnd_4     | -0.0281953    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | SWghtLB        | -0.0300976    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | SurpPreg_1     | -0.0039982    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | SmokTotl_1     | 0.0025847     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | SmokTotl_2     | -0.0052928    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | SmokTotl_3     | -0.0020928    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | DrnkFreq_1     | -0.0068801    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | DrnkFreq_2     | 0.0052751     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | peri_health    | 0.004202      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | caregiv_health | 0.0116073     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | gov_assist     | 0.0072691     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | SAAmylase.6    | 0.0316106     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | SAAmylase.15   | -0.0302033    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | SAAmylase.24   | -0.0039456    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | MDI.6          | 0.045877      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | MDI.15         | -0.0464581    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RHasSO.6_1     | 0.0649394     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RHasSO.15_1    | -0.0122696    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RHasSO.24_1    | -0.016981     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | RHasSO.35_1    | 0.0116232     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | WndNbrhood.6   | -0.0373403    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | WndNbrhood.24  | -0.0019188    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | WndNbrhood.35  | 0.0022994     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | IBRAttn.6      | -0.0320235    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | IBRAttn.15     | -0.0253199    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | IBRAttn.24     | -0.0374481    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | B18Raw.6       | 0.0166571     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | B18Raw.15      | 0.05197       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | B18Raw.24      | 0.0765156     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | HOMEETA1.6     | -0.0038514    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | HOMEETA1.15    | 0.0141675     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | HOMEETA1.24    | -0.0396161    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | HOMEETA1.35    | -0.0181728    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | InRatioCor.6   | -0.0211498    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | InRatioCor.15  | -0.0288416    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | InRatioCor.24  | -0.0306197    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | InRatioCor.35  | -0.0000526    | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | CORTB.6        | 0.0340154     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | CORTB.15       | 0.0126727     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | CORTB.24       | -0.0234944    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | EARS_TJo.24    | -0.0205829    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | EARS_TJo.35    | -0.0102596    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | LESMnPos.24    | -0.0325452    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | LESMnPos.35    | -0.0198341    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | LESMnNeg.24    | 0.0397035     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | LESMnNeg.35    | 0.0159513     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | StrDif_Tot.35  | 0.025157      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | fscore.35      | -0.0372589    | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | ESETA1.6       | 0.0391975     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | ESETA1.15      | 0.0257104     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | ESETA1.24      | 0.0109498     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | ESETA1.35      | 0.0073934     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Balance Stats for All Exposure Time Points Averaging Across Imputed Datasets</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">balance_stats.cbps</span>, </span>
<span>     t <span class="op">=</span> <span class="fl">4</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-46-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With real-world data, it is often difficult to fully balance the many confounding variables, especially across time. If a user does find that no confounders remain imbalanced, they can skip to Step 3d. Given that we identified remaining imbalanced confounders, we proceed to Step 3b. <br></p>
</section><section class="level3"><h4 id="step-3b--update-simplified-formulas">Step 3b. Update Simplified Formulas<a class="anchor" aria-label="anchor" href="#step-3b--update-simplified-formulas"></a>
</h4>
<p>Subsequently, we update the shortened formulas to include any time-varying confounders (<em>t</em>-1 +) that were not successfully balanced by the full formulas, as shown above. To do this, we create a final round of weights formulas using the <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function (setting <code>type</code> = “update” and providing the balance statistics of the <code>bal_stats</code> field). The <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function draws from user-provided balance statistics to automatically identify and add to the formulas at each exposure time point any time-varying confounders at lags greater than 1 that remain imbalanced after weighting. The function displays each weights formula in the console with a message to the user about any time-varying confounders that were added.</p>
<p>The required input to update the shortened weights formulas using the <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function are: an MSM object (e.g., “obj”), setting <code>type</code> = “update”, and providing to <code>bal_stats</code> the balance statistics that were just created in Step 3a.</p>
<p>The optional input are detailed in Step 1a.</p>
<p>The function returns a list of weights formulas labeled by type, exposure, outcome, and exposure time point.</p>
<p>Below, we update our short formulas using the balance statistics from the best-performing weights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"update"</span></span>
<span></span>
<span><span class="va">bal_stats</span> <span class="op">&lt;-</span> <span class="va">balance_stats.cbps</span></span>
<span></span>
<span><span class="va">updated_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createFormulas.html">createFormulas</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                   type <span class="op">=</span> <span class="va">type</span>,</span>
<span>                                   bal_stats <span class="op">=</span> <span class="va">bal_stats</span>,</span>
<span>                                   save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
<p>We then inspect these new formulas to make sure that the imbalanced covariates were added to the appropriate formulas. The user has the option to supply <code>save.out</code> to save printed output to the home directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">updated_formulas</span>, </span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span> </span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the updated balancing formula below that includes time-varying confounders at t-1 and those greater at further lags that remained imbalanced:</span></span>
<span><span class="co">#&gt; At time point 6, the update formula for ESETA1.6 is: </span></span>
<span><span class="co">#&gt; ESETA1.6 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the updated balancing formula below that includes time-varying confounders at t-1 and those greater at further lags that remained imbalanced:</span></span>
<span><span class="co">#&gt; At time point 15, the update formula for ESETA1.15 is: </span></span>
<span><span class="co">#&gt; ESETA1.15 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.6 + MDI.6 + RHasSO.6 + WndNbrhood.6 + IBRAttn.6 + B18Raw.6 + HOMEETA1.6 + InRatioCor.6 + CORTB.6 + ESETA1.6</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the updated balancing formula below that includes time-varying confounders at t-1 and those greater at further lags that remained imbalanced:</span></span>
<span><span class="co">#&gt; At time point 24, the update formula for ESETA1.24 is: </span></span>
<span><span class="co">#&gt; ESETA1.24 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.15 + MDI.15 + RHasSO.15 + IBRAttn.15 + B18Raw.15 + HOMEETA1.15 + InRatioCor.15 + CORTB.15 + ESETA1.15</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the updated balancing formula below that includes time-varying confounders at t-1 and those greater at further lags that remained imbalanced:</span></span>
<span><span class="co">#&gt; At time point 35, the update formula for ESETA1.35 is: </span></span>
<span><span class="co">#&gt; ESETA1.35 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + SAAmylase.24 + RHasSO.24 + WndNbrhood.24 + IBRAttn.24 + B18Raw.24 + HOMEETA1.24 + InRatioCor.24 + CORTB.24 + EARS_TJo.24 + LESMnPos.24 + LESMnNeg.24 + ESETA1.24 + InRatioCor.6 + InRatioCor.15</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the updated balancing formula below that includes time-varying confounders at t-1 and those greater at further lags that remained imbalanced:</span></span>
<span><span class="co">#&gt; At time point 58, the update formula for ESETA1.58 is: </span></span>
<span><span class="co">#&gt; ESETA1.58 ~ state + BioDadInHH2 + PmAge2 + PmBlac2 + TcBlac2 + PmMrSt2 + PmEd2 + KFASTScr + RMomAgeU + RHealth + HomeOwnd + SWghtLB + SurpPreg + SmokTotl + DrnkFreq + peri_health + caregiv_health + gov_assist + RHasSO.35 + WndNbrhood.35 + HOMEETA1.35 + InRatioCor.35 + EARS_TJo.35 + LESMnPos.35 + LESMnNeg.35 + StrDif_Tot.35 + fscore.35 + ESETA1.35</span></span></code></pre></div>
</div>
<p>As shown above, income at 6 and 15 months (“InRatioCor.6” and “InRatioCor.15”) were added to the 35-month weights formula. These were not originally in that weights formula given that they are lags greater than <em>t</em> -1. Their remaining imbalance suggests that achieving balance for 24-month income did not successfully balance prior levels of income. We will then use these weights formulas to recreate CBPS weights in an effort to achieve the greatest reduction in balance.</p>
<p><br></p>
</section><section class="level3"><h4 id="step-3c--create-final-balancing-weights">Step 3c. Create Final Balancing Weights<a class="anchor" aria-label="anchor" href="#step-3c--create-final-balancing-weights"></a>
</h4>
<p>Next, we create a final set of balancing weights using the optimal weighting method identified in Step 2c and the updated formulas from the previous step using the <code><a href="../reference/createWeights.html">createWeights()</a></code> function (<code>method</code> = “…’), with the SuperLearner method being the optimal weighting method identified in Step 2c. The function calls the <code>weightitMSM()</code> function from the <em>WeightIt</em> package (Greifer, 2024) that uses the time-specific formulas to create weights at each time point before automatically multiplying them together to create one weight per person. Weights are stabilized, as is recommended (Cole &amp; Hernan, 2008; Thoemmes &amp; Ong, 2016) and distributions are saved out in the home directory for inspection.</p>
<p>The required inputs for using the <code><a href="../reference/createWeights.html">createWeights()</a></code> function to create the final round of IPTW balancing weights using the updated short weights formulas are: complete data (data frame, mids object, or a list of imputed datasets as dataframes in wide format), an MSM object (e.g., “obj”), the best-performing weights method, and the updated formulas (see Step 3a).</p>
<p>The optional input for the <code><a href="../reference/createWeights.html">createWeights()</a></code> function are listed in Step 2b.</p>
<p>The function returns a list in the form of WeightItMSM output.</p>
<p>Below, we use the updated formulas and the CPBS weighting method to create a final round of IPTW balancing weights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formulas</span> <span class="op">&lt;-</span> <span class="va">updated_formulas</span></span>
<span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"cbps"</span></span>
<span></span>
<span><span class="va">final_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWeights.html">createWeights</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                               obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                               method <span class="op">=</span> <span class="va">method</span>, </span>
<span>                               formulas <span class="op">=</span> <span class="va">formulas</span>,</span>
<span>                               <span class="co"># max.it = 1, # testing only</span></span>
<span>                               save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
<p>We then inspect these final weights by imputed dataset. The user has the option to supply <code>save.out</code> to save printed or plot output to the home directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">final_weights</span>, </span>
<span>      i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `cbps` weighting method, the median weight value is 0.77 (SD = 1.17; range = 0-9).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">final_weights</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-50-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As shown above, these weights have a median value of 0.77 and a range of 0-9, the same as before.</p>
<p><br></p>
</section><section class="level3"><h4 id="d--trim-final-balancing-weights">3d. Trim Final Balancing Weights<a class="anchor" aria-label="anchor" href="#d--trim-final-balancing-weights"></a>
</h4>
<p>The next step is to trim (i.e., winsorize) this final set of weights to eliminate the heavy right tail of its distribution using the <code><a href="../reference/trimWeights.html">trimWeights()</a></code> function. This function draws on the <em>Weightit</em> package (Griefer, 2023) and plots and summarizes trimmed weights. This function outputs a list of trimmed weights with either a single nested list (labeled “0” if data are in data frame format) or with nested lists for each imputed dataset (if data are imputed).</p>
<p>The required input for the <code><a href="../reference/trimWeights.html">trimWeights()</a></code> function is the final weights we just created.</p>
<p>The optional input allows the user to specify a quantile value (0-1; default is 0.95) above which the weights will be replaced with the weight value of that quantile, to reduce the heavy right tail.</p>
<p>Below, we use the default 95th percentile for trimming weights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quantile</span> <span class="op">&lt;-</span> <span class="fl">0.95</span> </span></code></pre></div>
</div>
<p>We trim the final weights below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">final_weights</span></span>
<span></span>
<span><span class="va">trim_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trimWeights.html">trimWeights</a></span><span class="op">(</span>weights <span class="op">=</span> <span class="va">weights</span>, </span>
<span>                            at <span class="op">=</span> <span class="va">quantile</span>, </span>
<span>                            save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The function returns a list of weights objects, containing trimmed weights, each in the form of weightitMSM output ( with one entry per imputed dataset, where applicable). Each entry also specifies the quantile value at which the weights were trimmed.</p>
<p>We then inspect the trimmed weights from one of the imputed datasets below. The user has the option to supply <code>save.out</code> to save plots to the home directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trim_weights</span>, </span>
<span>      i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `cbps` weighting method, after trimming at 95th quantile, the median weight value is 0.77 (SD = 0.93; range = 0-4).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trim_weights</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-53-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br> As shown above, the weights still have a median value of 0.77 but a smaller standard deviation and a range that now only goes from 0-4.</p>
<p><br></p>
<section class="level4"><h5 id="sensitvity-analyses">Sensitvity Analyses<a class="anchor" aria-label="anchor" href="#sensitvity-analyses"></a>
</h5>
<p>We then create trimmed weights using two other quantile values at + /- ~0.3 of the previously chosen quantile value, in order to conduct the recommended sensitivity analyses at subsequent steps.</p>
<p>We first create weights at the 92nd quantile value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quantile</span> <span class="op">&lt;-</span> <span class="fl">0.92</span> </span>
<span></span>
<span><span class="va">trim_weights.s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trimWeights.html">trimWeights</a></span><span class="op">(</span>weights <span class="op">=</span> <span class="va">weights</span>, </span>
<span>                               at <span class="op">=</span> <span class="va">quantile</span>, </span>
<span>                               save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trim_weights.s1</span>, </span>
<span>      i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `cbps` weighting method, after trimming at 92th quantile, the median weight value is 0.77 (SD = 0.82; range = 0-3).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trim_weights.s1</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-54-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Trimming at the 92nd quantile preserves the same median of 0.77 but with an even smaller standard deviation and range.</p>
<p>And then at the 98th quantile value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quantile</span> <span class="op">&lt;-</span> <span class="fl">0.98</span> </span>
<span></span>
<span><span class="va">trim_weights.s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trimWeights.html">trimWeights</a></span><span class="op">(</span>weights <span class="op">=</span> <span class="va">weights</span>, </span>
<span>                               at <span class="op">=</span> <span class="va">quantile</span>, </span>
<span>                               save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trim_weights.s2</span>, </span>
<span>      i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For imputation 1 and the `cbps` weighting method, after trimming at 98th quantile, the median weight value is 0.77 (SD = 1.05; range = 0-5).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trim_weights.s2</span>, </span>
<span>     i <span class="op">=</span> <span class="fl">1</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-55-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Trimming instead at the 98th quantile produces a larger standard deviation and range.</p>
<p>We find comparable descriptive statistics for all sets of weights, with the upper range value varying by quantile cutoff. We will assess the consequences of any differences (e.g., different ranges) in subsequent steps.</p>
<p><br></p>
</section></section></section><section class="level2"><h3 id="step-4-conduct-final-balance-assessment">Step 4: Conduct Final Balance Assessment<a class="anchor" aria-label="anchor" href="#step-4-conduct-final-balance-assessment"></a>
</h3>
<p>Having created and trimmed the final set of IPTW balancing weights, the next step is to conduct a final evaluation of how well they reduce imbalance. We assess the performance of the final trimmed and untrimmed weights using <code><a href="../reference/assessBalance.html">assessBalance()</a></code> function.</p>
<p>The required inputs for using the <code><a href="../reference/assessBalance.html">assessBalance()</a></code> function to assess how the final, trimmed weights achieve balance for the full formulas are: complete data (data frame, mids object, or a list of imputed datasets as dataframes in wide format), an MSM object (e.g., “obj”), and weights.</p>
<p>The optional inputs for the <code><a href="../reference/assessBalance.html">assessBalance()</a></code> function are detailed in Step 1b.</p>
<p>Below, we assess balance for our trimmed weights.</p>
<section class="level3"><h4 id="trimmed">Trimmed<a class="anchor" aria-label="anchor" href="#trimmed"></a>
</h4>
<p>Assess balance of trimmed weights</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">trim_weights</span></span>
<span></span>
<span><span class="va">final_balance_stats_trim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                     obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                     balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>,</span>
<span>                                     imp_conf <span class="op">=</span> <span class="va">imp_conf</span>,</span>
<span>                                     weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>                                     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Summarize and inspect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_balance_stats_trim</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `cbps` weighting method: As shown below, 1 out of 241 (0.4%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.05 (max: 0.05):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 1                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `cbps`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">final_balance_stats_trim</span>, </span>
<span>      t <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | exposure  | covariate      | std_bal_stats | bal_thresh | balanced |</span></span>
<span><span class="co">#&gt; +===========+================+===============+============+==========+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | state_1        | 0.017187      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | BioDadInHH2_1  | -0.016301     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmAge2         | -0.008023     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmBlac2_1      | 0.016619      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | TcBlac2_1      | 0.018255      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmMrSt2_1      | -0.005111     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmEd2          | -0.037446     | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | KFASTScr       | -0.019384     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RMomAgeU       | -0.004177     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_1      | 0.002172      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_2      | -0.008695     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_3      | 0.004038      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_4      | 0.007655      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_5      | -0.011764     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_1     | -0.004552     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_2     | 0.003749      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_3     | 0.004181      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_4     | 0.010202      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SWghtLB        | -0.000544     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SurpPreg_1     | 0.009309      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SmokTotl_1     | 0.010632      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SmokTotl_2     | 0.008245      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SmokTotl_3     | -0.00517      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | DrnkFreq_1     | 0.009758      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | DrnkFreq_2     | -0.01846      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | peri_health    | -0.001015     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | caregiv_health | 0.009527      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | gov_assist     | 0.014942      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SAAmylase.6    | 0.009242      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | MDI.6          | 0.010528      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHasSO.6_1     | 0.020749      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | WndNbrhood.6   | -0.016214     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | IBRAttn.6      | -0.003917     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | B18Raw.6       | 0.027468      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HOMEETA1.6     | -0.023463     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | InRatioCor.6   | -0.050616     | 0.05       | 0        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | CORTB.6        | -0.005383     | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | ESETA1.6       | 0.034089      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Balance Stats for Exposure Time 2 Averaging Across Imputed Datasets</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trim_weights</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Summary of weights</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight ranges:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Min                                  Max</span></span>
<span><span class="co">#&gt; all   0 |---------------------------| 3.5109</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Units with the 5 most extreme weights:</span></span>
<span><span class="co">#&gt;                                        </span></span>
<span><span class="co">#&gt;          89     79     30     27     11</span></span>
<span><span class="co">#&gt;  all 3.5109 3.5109 3.5109 3.5109 3.5109</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight statistics:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Coef of Var   MAD Entropy # Zeros</span></span>
<span><span class="co">#&gt; all       0.893 0.685   0.371       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Effective Sample Sizes:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Total</span></span>
<span><span class="co">#&gt; Unweighted 1292. </span></span>
<span><span class="co">#&gt; Weighted    718.9</span></span></code></pre></div>
</div>
<p>As shown above, the trimmed weights result in one imbalanced confounder in relation to exposure at 15 months and an effective sample size of 719.</p>
</section><section class="level3"><h4 id="untrimmed">Untrimmed<a class="anchor" aria-label="anchor" href="#untrimmed"></a>
</h4>
<p>We then assess balance of untrimmed weights</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">final_weights</span></span>
<span></span>
<span><span class="va">final_balance_stats_untrim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                     obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                     balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>,</span>
<span>                                     imp_conf <span class="op">=</span> <span class="va">imp_conf</span>,</span>
<span>                                     weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>                                     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Summarize and inspect</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_balance_stats_untrim</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Averaging across imputed datasets using cbps weighting method.</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `cbps` weighting method: As shown below, 0 out of 241 (0.0%) covariates across time points remain imbalanced:</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `cbps`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_weights</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                   Summary of weights</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight ranges:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Min                                  Max</span></span>
<span><span class="co">#&gt; all   0 |---------------------------| 8.5406</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Units with the 5 most extreme weights:</span></span>
<span><span class="co">#&gt;                                        </span></span>
<span><span class="co">#&gt;         877   1145    697    294    919</span></span>
<span><span class="co">#&gt;  all 7.1324 7.3945 7.7172 8.5239 8.5406</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Weight statistics:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Coef of Var   MAD Entropy # Zeros</span></span>
<span><span class="co">#&gt; all       1.056 0.722   0.439       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Effective Sample Sizes:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Total</span></span>
<span><span class="co">#&gt; Unweighted 1292.  </span></span>
<span><span class="co">#&gt; Weighted    611.17</span></span></code></pre></div>
</div>
<p>We see that the non-trimmed weights result in no imbalanced confounders and an effective sample size of 611.</p>
<p>In this scenario, given that, for the trimmed weights, the imbalanced confounder (income at 6 months) is only related to exposure at -0.051 and the trimmed weights yield a higher effective sample size, we proceed with the trimmed weights.</p>
<p>We then summarize the final balance statistics, averaging across imputed datasets. The user has the option to supply <code>save.out</code> to save plot output to the home directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_balance_stats_trim</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `cbps` weighting method: As shown below, 1 out of 241 (0.4%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.05 (max: 0.05):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 1                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `cbps`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">final_balance_stats_trim</span>, </span>
<span>     t <span class="op">=</span> <span class="fl">2</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-60-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the outcome modeling step (Step 5), users have the option to include any remaining imbalanced confounders that are time invariant as covariates in the final outcome model. In this case, we would manually list out these imbalanced confounders that are time invariant and assign them to <code>covariates</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># covariates &lt;- c("list_imbalanced_ti_conf")</span></span></code></pre></div>
</div>
<p><br></p>
</section><section class="level3"><h4 id="sensitvity-analyses-1">Sensitvity Analyses<a class="anchor" aria-label="anchor" href="#sensitvity-analyses-1"></a>
</h4>
<p>Subsequently, we also assess balance for the weights trimmed at the two additional quantile values to assess whether the final balance assessment is sensitive to the trim value.</p>
<p>We first assess balance for the weights trimmed at the 93rd quantile value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">trim_weights.s1</span></span>
<span></span>
<span><span class="va">final_balance_stats.s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                        obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                        weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>                                        imp_conf <span class="op">=</span> <span class="va">imp_conf</span>, </span>
<span>                                        balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>, </span>
<span>                                        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_balance_stats.s1</span>, </span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `cbps` weighting method: As shown below, 1 out of 241 (0.4%) covariates across time points remain imbalanced with a remaining median absolute correlation of 0.06 (max: 0.06):</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 1                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `cbps`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">final_balance_stats.s1</span>, </span>
<span>      t <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | exposure  | covariate      | std_bal_stats | bal_thresh | balanced |</span></span>
<span><span class="co">#&gt; +===========+================+===============+============+==========+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | state_1        | 0.02175       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | BioDadInHH2_1  | -0.01857      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmAge2         | -0.00978      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmBlac2_1      | 0.02279       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | TcBlac2_1      | 0.02269       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmMrSt2_1      | -0.00654      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | PmEd2          | -0.04287      | 0.05       | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | KFASTScr       | -0.0261       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RMomAgeU       | -0.00973      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_1      | -0.00117      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_2      | -0.00813      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_3      | 0.00942       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_4      | 0.00349       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHealth_5      | -0.01243      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_1     | -0.00602      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_2     | 0.00153       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_3     | 0.00942       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HomeOwnd_4     | 0.00996       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SWghtLB        | -0.00312      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SurpPreg_1     | 0.01335       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SmokTotl_1     | 0.01352       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SmokTotl_2     | 0.01077       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SmokTotl_3     | -0.00753      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | DrnkFreq_1     | 0.01492       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | DrnkFreq_2     | -0.02308      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | peri_health    | -0.00114      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | caregiv_health | 0.01331       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | gov_assist     | 0.01817       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | SAAmylase.6    | 0.01058       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | MDI.6          | 0.01466       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | RHasSO.6_1     | 0.0201        | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | WndNbrhood.6   | -0.02011      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | IBRAttn.6      | -0.00386      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | B18Raw.6       | 0.0289        | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | HOMEETA1.6     | -0.02621      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | InRatioCor.6   | -0.06194      | 0.05       | 0        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | CORTB.6        | -0.00842      | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | ESETA1.6       | 0.04248       | 0.1        | 1        |</span></span>
<span><span class="co">#&gt; +-----------+----------------+---------------+------------+----------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Balance Stats for Exposure Time 2 Averaging Across Imputed Datasets</span></span></code></pre></div>
</div>
<p>From this, we similarly find that income at 6 months is imbalanced with respect to exposure at 15 months (albeit with a slighter stronger correlation than the main analyses).</p>
<p><br></p>
<p>We next assess balance for the weights trimmed at the 98th quantile value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">trim_weights.s2</span></span>
<span></span>
<span><span class="va">final_balance_stats.s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessBalance.html">assessBalance</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                                        obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                                        weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>                                        imp_conf <span class="op">=</span> <span class="va">imp_conf</span>, </span>
<span>                                        balance_thresh <span class="op">=</span> <span class="va">balance_thresh</span>, </span>
<span>                                        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">final_balance_stats.s2</span>, </span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Averaging across imputed datasets using cbps weighting method.</span></span>
<span><span class="co">#&gt; USER ALERT: Averaging across imputed datasets using `cbps` weighting method: As shown below, 0 out of 241 (0.0%) covariates across time points remain imbalanced:</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | Exposure  | Total # of covariates | # of imbalanced covariates |</span></span>
<span><span class="co">#&gt; +===========+=======================+============================+</span></span>
<span><span class="co">#&gt; | ESETA1.6  | 28                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.15 | 38                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.24 | 47                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.35 | 59                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; | ESETA1.58 | 69                    | 0                          |</span></span>
<span><span class="co">#&gt; +-----------+-----------------------+----------------------------+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Imbalanced Covariates Averaging Across Imputed Datasetrs using `cbps`</span></span></code></pre></div>
</div>
<p>From this, we find no remaining imbalanced confounders (similar to the untrimmed results).</p>
<p><br><br></p>
</section></section></section><section class="section level2"><h2 id="phase-2-assess-substantive-associations-between-exposure-and-outcome">PHASE 2: Assess Substantive Associations between Exposure and Outcome<a class="anchor" aria-label="anchor" href="#phase-2-assess-substantive-associations-between-exposure-and-outcome"></a>
</h2>
<p>Having created IPTW balancing weights that minimize associations between confounders and exposure at each time point, we can move to the substantive modeling phase.<br><br></p>
<section class="level2"><h3 id="step-5-fit-weighted-outcome-model">Step 5: Fit Weighted Outcome Model<a class="anchor" aria-label="anchor" href="#step-5-fit-weighted-outcome-model"></a>
</h3>
<p>The goal of this final step is to fit a weighted model relating exposure at meaningful epochs of developmental time to the outcome, before summarizing and visualizing the results. In this step, the user models and compares various counterfactuals, or the effects of different developmental histories of exposure on the outcome, to test substantive hypotheses about dose and timing.</p>
<p><br></p>
<section class="level3"><h4 id="step-5a--select-a-weighted-outcome-model">Step 5a. Select a Weighted Outcome Model<a class="anchor" aria-label="anchor" href="#step-5a--select-a-weighted-outcome-model"></a>
</h4>
<p>First, we use the <code><a href="../reference/fitModel.html">fitModel()</a></code> function to fit a weighted generalized linear model relating exposure to outcome. The function draws on the <code>glm_weightit()</code> function of the <em>WeightIt</em> package (Greifer, 2024). The exposure main effects in models reflect exposure levels at each exposure time point unless exposure epochs are specified. One of the benefits of creating balancing weights is that they can be used in a variety of different marginal outcome models and those encompassed in this function are only a subset of possible models. Note that these models can get complex and we do not advise interpreting the individual terms.</p>
<p>The required inputs for using the <code><a href="../reference/fitModel.html">fitModel()</a></code> function are: complete data (data frame, mids object, or a list of imputed datasets as dataframes in wide format), an MSM object (e.g., “obj”), an outcome, a list of trimmed weights, and a model from the list below (“m0”, “m1”, “m2”, or “m3”).</p>
<p>We first inspect the following list of models.</p>
<ul>
<li><p><em>M0</em>: Baseline model regressing the outcome on the main effects of exposure (e.g., infancy, toddlerhood, childhood).</p></li>
<li><p><em>M1</em>: Covariate model regressing the outcome on the main effects of exposure as well as user-specified covariates (e.g., confounders measured at baseline or the first time point that remained imbalanced after weighting in Step 4).</p></li>
<li><p><em>M2</em>: Interaction model regressing the outcome on the main effects of exposure as well as all interactions between exposure main effects (e.g., infancy:toddlerhood) of the user-specified interaction order</p></li>
<li><p><em>M3</em>: Full model regressing the outcome on the main effects of exposure, user-specified covariates, as well as all exposure main effect interactions and interactions between expoure and covariates, of the user-specified interaction order</p></li>
</ul>
<p>Below, we specify the M0 model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"m0"</span></span></code></pre></div>
</div>
<p>If the user selects a covariate model (“m1” or “m3”), they are required to supply a list to <code>covariates</code> that corresponds to covariates in the wide data (see Step 4).</p>
<p>The optional inputs to the <code><a href="../reference/fitModel.html">fitModel()</a></code> function are as follows.</p>
<p>If the user selects an interaction model (“m2” or “m3”), they are required to provide a interaction order integer in the <code>int_order</code> field that reflects the maximum interaction (e.g., 3) (that will automatically include all lower order interactions (e.g., 2-way)). The interaction order cannot exceed the total number of exposure main effects (3 in our case, as we specified 3 exposure epochs).</p>
<p>If we were to specify an interaction model (“m2” or “m3”), we would also need to specify the interaction order ( to be included with all lower-level interactoins) between exposure main effects to the <code><a href="../reference/fitModel.html">fitModel()</a></code> function below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#int_order &lt;- 2</span></span></code></pre></div>
</div>
<p>The user can also specify a <code>family</code> (as a function, not in quotations; e.g., gaussian) and <code>link</code> (in quotations, e.g., “identity”) functions for the generalized linear model (defaults are gaussian and “link”, respectively). The possible families are: binomial, gaussian, Gama, inverse.gaussian, poisson, quasi, quasibinomial, and quasipoisson. For binomial and Poisson families, set family to quasibinomial and quasipoisson, respectively, to avoid a warning about non-integer numbers of successes. The `quasi’ versions of the family objects give the same point estimates and standard errors and do not give the warning. The gaussian family accepts the links: “identity”, “log” and “inverse”; the binomial family the links “logit”, “probit”, “cauchit”, (corresponding to logistic, normal and Cauchy CDFs respectively) “log” and “cloglog” (complementary log-log); the Gamma family the links “inverse”, “identity”, and “log”; the poisson family the links “log”, “identity”, and “sqrt”; and the inverse.gaussian family the links 1/mu^2, inverse, identity and log. The quasi family accepts the links “logit”, “probit”, “cloglog”, “identity”, “inverse”, “log”, “1/mu^2”, and “sqrt”, and the function power can be used to create a power link function.</p>
<p>Below, we retain the default family and link functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">family</span> <span class="op">&lt;-</span> <span class="va">gaussian</span></span>
<span></span>
<span><span class="va">link</span> <span class="op">&lt;-</span> <span class="st">"identity"</span> </span></code></pre></div>
</div>
<p>This function returns a list of fitted model objects, each as glm output.</p>
</section><section class="level3"><h4 id="step-5b--fit-the-weighted-outcome-model">Step 5b. Fit the Weighted Outcome Model<a class="anchor" aria-label="anchor" href="#step-5b--fit-the-weighted-outcome-model"></a>
</h4>
<p>We fit the outcome model using trimmed weights below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">trim_weights</span></span>
<span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitModel.html">fitModel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                   obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                   weights <span class="op">=</span> <span class="va">weights</span>, </span>
<span>                   outcome <span class="op">=</span> <span class="va">outcome</span>, </span>
<span>                   model <span class="op">=</span> <span class="va">m</span>,</span>
<span>                   family <span class="op">=</span> <span class="va">family</span>,</span>
<span>                   link <span class="op">=</span> <span class="va">link</span>,</span>
<span>                   save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span> </span></code></pre></div>
</div>
<p>The function returns a list of models (one per imputed dataset, where applicable).</p>
<p>We then inspect the model output. The user has the option to supply <code>save.out</code> to save printed output to the home directory.</p>
<p>We inspect the model averaged across imputed datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">models</span>, </span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in pool.vector(w, dfcom = dfcom, custom.t = custom.t, rule = rule):</span></span>
<span><span class="co">#&gt; Large sample assumed.</span></span>
<span><span class="co">#&gt; Please inspect the Wald test to determine if the exposures collectively predict significant variation in the outcome compared to a model without exposure terms.</span></span>
<span><span class="co">#&gt; We strongly suggest only conducting history comparisons if the test is significant.</span></span>
<span><span class="co">#&gt;    test statistic df1       df2 dfcom p.value      riv</span></span>
<span><span class="co">#&gt;  1 ~~ 2 -1.295481   3 0.4041478    NA       1 2.226466</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The marginal model, m0, pooled across imputed datasets is summarized below:</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; |                    | (1)                              |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; |                    | Est.  | CI              | p      |</span></span>
<span><span class="co">#&gt; +====================+=======+=================+========+</span></span>
<span><span class="co">#&gt; | (Intercept)        | 0.482 | [0.448, 0.516]  | &lt;0.001 |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | ESETA1.Childhood   | 0.029 | [-0.104, 0.163] | 0.418  |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | ESETA1.Infancy     | 0.004 | [-0.036, 0.044] | 0.845  |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | ESETA1.Toddlerhood | 0.011 | [-0.047, 0.069] | 0.671  |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | Num.Obs.           | 1292  |                 |        |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span></code></pre></div>
</div>
<p>Importantly, we first examine the results of the Wald test at the top of the output. In the case of imputed data, the likelihood ratio test is done by pooling parameters via Rubin’s Rules. This test compares the user-specified model to a nested version of that model that omits all exposure variables to test whether exposure predicts variation in the outcome. Models are pooled prior to conducting the likelihood ratio test for imputed data.)</p>
<p><br></p>
<section class="level4"><h5 id="sensitivity-analyses">Sensitivity Analyses<a class="anchor" aria-label="anchor" href="#sensitivity-analyses"></a>
</h5>
<p>We then conduct sensitivity analyses, fitting the same model with weights that were trimmed at two different values.</p>
<p>Of note if <code>save.out</code> = TRUE using the default file naming, saving the model output will overwrite the output from the main model. To save out sensitivity analyses, we recomend the user supply a new name (e.g., <code>save.out</code> = “model_m1_s1.rds”).</p>
<p>We first fit the same model to the weights trimmed at the 92nd quantile.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">trim_weights.s1</span></span>
<span></span>
<span><span class="va">models.s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitModel.html">fitModel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                      obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                      weights <span class="op">=</span> <span class="va">weights</span>, </span>
<span>                      outcome <span class="op">=</span> <span class="va">outcome</span>, </span>
<span>                      model <span class="op">=</span> <span class="va">m</span>,</span>
<span>                      family <span class="op">=</span> <span class="va">family</span>,</span>
<span>                      link <span class="op">=</span> <span class="va">link</span>,</span>
<span>                      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">models.s1</span>, </span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in pool.vector(w, dfcom = dfcom, custom.t = custom.t, rule = rule):</span></span>
<span><span class="co">#&gt; Large sample assumed.</span></span>
<span><span class="co">#&gt; Please inspect the Wald test to determine if the exposures collectively predict significant variation in the outcome compared to a model without exposure terms.</span></span>
<span><span class="co">#&gt; We strongly suggest only conducting history comparisons if the test is significant.</span></span>
<span><span class="co">#&gt;    test  statistic df1       df2 dfcom p.value      riv</span></span>
<span><span class="co">#&gt;  1 ~~ 2 -0.3020541   3 0.6594868    NA       1 1.174867</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The marginal model, m0, pooled across imputed datasets is summarized below:</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; |                    | (1)                              |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; |                    | Est.  | CI              | p      |</span></span>
<span><span class="co">#&gt; +====================+=======+=================+========+</span></span>
<span><span class="co">#&gt; | (Intercept)        | 0.481 | [0.448, 0.514]  | &lt;0.001 |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | ESETA1.Childhood   | 0.029 | [-0.072, 0.130] | 0.357  |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | ESETA1.Infancy     | 0.006 | [-0.039, 0.051] | 0.782  |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | ESETA1.Toddlerhood | 0.014 | [-0.064, 0.092] | 0.628  |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | Num.Obs.           | 1292  |                 |        |</span></span>
<span><span class="co">#&gt; +--------------------+-------+-----------------+--------+</span></span></code></pre></div>
</div>
<p>We similarly find a significant likelihoood ratio test.</p>
<p><b></b></p>
<b>
</b><p>We then fit the same model with the weights trimmed at the 98th quantile.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">trim_weights.s2</span></span>
<span></span>
<span><span class="va">models.s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitModel.html">fitModel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, </span>
<span>                      obj <span class="op">=</span> <span class="va">obj</span>, </span>
<span>                      weights <span class="op">=</span> <span class="va">weights</span>, </span>
<span>                      outcome <span class="op">=</span> <span class="va">outcome</span>, </span>
<span>                      model <span class="op">=</span> <span class="va">m</span>,</span>
<span>                      family <span class="op">=</span> <span class="va">family</span>,</span>
<span>                      link <span class="op">=</span> <span class="va">link</span>,</span>
<span>                      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">models.s2</span>, </span>
<span>      save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in pool.vector(w, dfcom = dfcom, custom.t = custom.t, rule = rule):</span></span>
<span><span class="co">#&gt; Large sample assumed.</span></span>
<span><span class="co">#&gt; Please inspect the Wald test to determine if the exposures collectively predict significant variation in the outcome compared to a model without exposure terms.</span></span>
<span><span class="co">#&gt; We strongly suggest only conducting history comparisons if the test is significant.</span></span>
<span><span class="co">#&gt;    test statistic df1       df2 dfcom p.value      riv</span></span>
<span><span class="co">#&gt;  1 ~~ 2 -1.758771   3 0.3310941    NA       1 3.208769</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The marginal model, m0, pooled across imputed datasets is summarized below:</span></span>
<span><span class="co">#&gt; +--------------------+--------+-----------------+--------+</span></span>
<span><span class="co">#&gt; |                    | (1)                               |</span></span>
<span><span class="co">#&gt; +--------------------+--------+-----------------+--------+</span></span>
<span><span class="co">#&gt; |                    | Est.   | CI              | p      |</span></span>
<span><span class="co">#&gt; +====================+========+=================+========+</span></span>
<span><span class="co">#&gt; | (Intercept)        | 0.483  | [0.448, 0.518]  | &lt;0.001 |</span></span>
<span><span class="co">#&gt; +--------------------+--------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | ESETA1.Childhood   | 0.030  | [-0.142, 0.202] | 0.466  |</span></span>
<span><span class="co">#&gt; +--------------------+--------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | ESETA1.Infancy     | -0.000 | [-0.045, 0.044] | 0.982  |</span></span>
<span><span class="co">#&gt; +--------------------+--------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | ESETA1.Toddlerhood | 0.007  | [-0.053, 0.067] | 0.778  |</span></span>
<span><span class="co">#&gt; +--------------------+--------+-----------------+--------+</span></span>
<span><span class="co">#&gt; | Num.Obs.           | 1292   |                 |        |</span></span>
<span><span class="co">#&gt; +--------------------+--------+-----------------+--------+</span></span></code></pre></div>
</div>
<p>With a comparable result. <b></b></p>
<b>
</b></section><b><b>
</b></b></section><b><b>
</b></b></section><b><b>
<section class="level2"><h3 id="step-6--estimate-compare-and-visualize-model-predicted-outcome-as-a-function-of-exposure-history">Step 6. Estimate, Compare, and Visualize Model-Predicted Outcome as a Function of Exposure History<a class="anchor" aria-label="anchor" href="#step-6--estimate-compare-and-visualize-model-predicted-outcome-as-a-function-of-exposure-history"></a>
</h3>
<p>In this final step, we use the fitted model results to test substantive hypotheses about dose and timing. We estimate and then compare the average marginal estimates of the outcome for each user-specified exposure history (i.e., permutation of high (“h”) and low (“l”) levels of exposure at each exposure epoch) using the <code><a href="../reference/compareHistories.html">compareHistories()</a></code> function. This draws primarily from the <code>avg_predictions()</code> and <code>hypotheses()</code> functions in the <em>marginaleffects</em> package (Arel-Bundock, 2023).</p>
<p>First, the <code><a href="../reference/compareHistories.html">compareHistories()</a></code> function creates average predictions of the outcome for each exposure history. For each of the <em>n</em> combinations of user-specified exposure histories, we set the value of those predictors in the full dataset to the values in that combination, leaving all other variables as they are. This gives us <em>n</em> datasets, each the same size as our original dataset used to fit the model. For the <em>n</em> datasets, we then compute the predicted values given the model before taking the average predicted value for each of the <em>n</em> datasets. These <em>n</em> averaged predicted values are the expected potential outcomes under each combination. (For imputed data, the function outputs pooled predicted values using Rubin’s Rules.)</p>
<p>Next, using the predicted values, the function conducts comparisons of the different histories (pooling across imputed datasets for imputed data using Rubin’s Rules). Lastly, the function implements correction for multiple comparisons (treating each run of the function as a family) before plotting the results. Box plots display outcome on the x-axis and exposure history on the y-axis and whiskers display standard errors.</p>
<p>The required inputs for using the <code><a href="../reference/compareHistories.html">compareHistories()</a></code> function are: an MSM object (e.g., “obj”) and a fitted model output (from the previous steps).</p>
<p>The optional inputs are as follows.</p>
<p>To create histories of high and low values with continuous exposures, to <code>hi_lo_cut</code> the user can specify a list of two quantile values (0-1; default is median split +/- 0.001) demarcating high and low levels of exposure, respectively. (Imputed data are stacked to calculate exemplar cutoff values.) We suggest drawing on existing hypotheses and examining the variability in the exposure variable to determine high and low exemplar cutoffs. We recommend users begin by specifying meaningful high and low percentile exemplar cutoffs and examining how many individuals in the sample fall into each of the user-specified exposure histories created by those percentile cutoffs (see the <a href="https://istallworthy.github.io/devMSMs/articles/Specify_Core_Inputs.html">Specify Core Inputs vignette</a>). While there are no gold standard recommendations for sufficient cell numbers per history, users should ensure that there is is reasonable coverage in all of their histories to avoid extrapolation and maximize precision.</p>
<p>Below, we draw on the high and low exemplar cutoffs that we previously specified, that 60th and 30th percentile values to denote high and low levels of economic strain, respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hi_lo_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.3</span><span class="op">)</span> </span></code></pre></div>
</div>
<p>The user also has the option to estimate and compare only a custom subset of user-specified exposure histories (i.e., sequences of high and low levels of exposure at each epoch or time point) using the <code>reference</code> and <code>comparison</code> fields. To conduct these recommended customized comparisons, users must provide at least one unique valid history (e.g., “l-l-l”) as a reference by, in quotations, provide a string (or a list of strings) of lowercase l’s and h’s (each separated by -), each corresponding to each exposure epoch (or time point), that signify the sequence of exposure levels (“low” or “high”, respectively). If the user supplies a reference history, they are required to provide at least one unique and valid history for comparison by, in quotations, providing to <code>comparison</code> a string (or list of strings) of l’s and h’s (each separated by “-”), with each corresponding to each exposure epoch, that signify the sequence of exposure levels (“low” or “high”, respectively) that constitutes the comparison exposure history/histories to be compared to the reference. If the user supplies one or more comparisons, at least one reference must be specified. Each reference exposure history will be compared to each comparison history and all comparisons will be subject to multiple comparison correction.</p>
<p>If no reference or comparison is specified, all histories will be compared to each other. If there are more than 4 exposure main effects (either as epochs or exposure time points), the user is required to select a subset of history comparisons (Step 6), given that the base code (see the <code>hypotheses()</code> function from the <em>marginaleffects</em> package; Arel-Bundock, 2023) cannot accommodate all pairwise history comparisons for more than 5 time points.</p>
<p>The user can also specify a multiple comparison method in <code>mc_method</code> by in quotations, providing the shorthand for the method (“holm”, “hochberg”,“hommel”, “bonferroni”, “BH” (default), “BY”, “fdr”, or “n” (see stats::p.adjust documentation; R Core Team) for multiple comparison correction to be applied to the final (pooled across imputed datasets when applicable) contrasts comparing effects of different exposure histories on outcome (default is Benjamini-Hochburg). Each code run is considered a family. If the user iterates through this function specifying different comparisons each time, we strongly recommend interpreting the outcome of the most inclusive set of comparisons to avoid false discovery.</p>
<p>Below, we retain the default Benjamini-Hochburg method for multiple comparison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mc_comp_method</span> <span class="op">&lt;-</span> <span class="st">"BH"</span></span></code></pre></div>
</div>
<p>Based on their substantive interests, the user also has the option to choose which level of dosage (“h” or “l”) is tallied in labels of dose counts in the tables and figures (<code>dose_level</code>; default is “h”). For example, if the exposure variable was coded in such a way that lower levels are conceptualized as the exposure (e.g., lower income), the user may wish to choose dosage level “l”.</p>
<p>Below, given our interest in histories of high economic strain, we specify that we wish to tally high doses of exposure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dose_level</span> <span class="op">&lt;-</span> <span class="st">"h"</span></span></code></pre></div>
</div>
<p>Lastly, the user can provide alternate plotting labels for exposure and outcome in the <code>exp_lab</code> and <code>out_lab</code> fields (defaults are variable names), as well as a list (equal to number of exposure main effects +1) of colors or a Brewer color palette (colors; default is “Dark2”). See RColorBrewer::display.brewer.all() or https://r-graph-gallery.com/38-rcolorbrewers-palettes.html).</p>
<p>Below, we specify plotting labels and 4 colors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_lab</span> <span class="op">&lt;-</span> <span class="st">"Economic Strain"</span> </span>
<span></span>
<span><span class="va">out_lab</span> <span class="op">&lt;-</span> <span class="st">"Behavior Problems"</span> </span>
<span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue4"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkgoldenrod"</span>, <span class="st">"red2"</span><span class="op">)</span></span></code></pre></div>
</div>
<section class="level3"><h4 id="step-6a--estimate-compare-potential-outcomes-across-exposure-histories">Step 6a. Estimate &amp; Compare Potential Outcomes Across Exposure Histories<a class="anchor" aria-label="anchor" href="#step-6a--estimate-compare-potential-outcomes-across-exposure-histories"></a>
</h4>
<p>The function returns a data frame of user-specified history comparisons containing contrast estimates, standard errors, statistics, p-values, low and high confidence intervals, and corrected p-values, labeled by history and dose.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">models</span> </span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compareHistories.html">compareHistories</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">model</span>, </span>
<span>                            comparison <span class="op">=</span> <span class="va">comparison</span>, </span>
<span>                            reference <span class="op">=</span> <span class="va">reference</span>, </span>
<span>                            hi_lo_cut <span class="op">=</span> <span class="va">hi_lo_cut</span>,</span>
<span>                            mc_comp_method <span class="op">=</span> <span class="va">mc_comp_method</span>, </span>
<span>                            dose <span class="op">=</span> <span class="st">"h"</span>,</span>
<span>                            save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in pool.vector(w, dfcom = dfcom, custom.t = custom.t, rule = rule):</span></span>
<span><span class="co">#&gt; Large sample assumed.</span></span>
<span><span class="co">#&gt; Warning in pool.vector(w, dfcom = dfcom, custom.t = custom.t, rule = rule):</span></span>
<span><span class="co">#&gt; Large sample assumed.</span></span></code></pre></div>
</div>
<p>The function outputs a list with two entries. The first contains predicted values for each history and the second contains the comparisons.</p>
<p>We then inspect the compared histories output (now averaged across all imputed datsets). The user has the option to supply <code>save.out</code> to save printed output to the home directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Summary of Exposure Main Effects:</span></span>
<span><span class="co">#&gt; USER ALERT: Out of the total of 1292 individuals in the sample, below is the distribution of the 333 (26%) individuals that fall into 2 user-selected exposure histories (out of the 27 total) created from 30th and 60th percentile values for low and high levels of exposure-epoch Infancy, Toddlerhood, Childhood.</span></span>
<span><span class="co">#&gt; USER ALERT: Please inspect the distribution of the sample across the following exposure histories and ensure there is sufficient spread to avoid extrapolation and low precision:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +---------------+-----+</span></span>
<span><span class="co">#&gt; | epoch_history | n   |</span></span>
<span><span class="co">#&gt; +===============+=====+</span></span>
<span><span class="co">#&gt; | h-h-h         | 214 |</span></span>
<span><span class="co">#&gt; +---------------+-----+</span></span>
<span><span class="co">#&gt; | l-l-l         | 119 |</span></span>
<span><span class="co">#&gt; +---------------+-----+</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Summary of user-selected exposure histories based on exposure main effects Infancy, Toddlerhood, Childhood: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Below are the pooled average predictions by user-specified history:</span></span>
<span><span class="co">#&gt; +-------+----------+-----------+----------+-----------+</span></span>
<span><span class="co">#&gt; | term  | estimate | std.error | conf.low | conf.high |</span></span>
<span><span class="co">#&gt; +=======+==========+===========+==========+===========+</span></span>
<span><span class="co">#&gt; | l-l-l | 0.47     | 0.014     | 0.44     | 0.49      |</span></span>
<span><span class="co">#&gt; +-------+----------+-----------+----------+-----------+</span></span>
<span><span class="co">#&gt; | h-h-h | 0.5      | 0.02      | 0.42     | 0.57      |</span></span>
<span><span class="co">#&gt; +-------+----------+-----------+----------+-----------+ </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conducting multiple comparison correction for all pairings between comparison histories and each refernece history using the BH method. </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +-------------------+------------+------------+-----------+-------------+------------+--------------+</span></span>
<span><span class="co">#&gt; | term              | estimate   | std.error  | p.value   | conf.low    | conf.high  | p.value_corr |</span></span>
<span><span class="co">#&gt; +===================+============+============+===========+=============+============+==============+</span></span>
<span><span class="co">#&gt; | (h-h-h) - (l-l-l) | 0.03035381 | 0.01948617 | 0.1991629 | -0.02526463 | 0.08597225 | 0.1991629    |</span></span>
<span><span class="co">#&gt; +-------------------+------------+------------+-----------+-------------+------------+--------------+</span></span></code></pre></div>
</div>
<p>We first confirm the distribution of our sample across our exposure histories is reasonable.</p>
<p>We then summarize these results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt;                term   estimate  std.error statistic       df   p.value</span></span>
<span><span class="co">#&gt; 1 (h-h-h) - (l-l-l) 0.03035381 0.01948617   1.55771 3.739988 0.1991629</span></span>
<span><span class="co">#&gt;      conf.low  conf.high    conf.low  conf.high  dose p.value_corr</span></span>
<span><span class="co">#&gt; 1 -0.02526463 0.08597225 -0.02526463 0.08597225 3 - 0    0.1991629</span></span></code></pre></div>
</div>
<p>We then inspect the history comparison and conclude that there is no evidence that children who experienced different histories of exposure to economic strain over infancy, toddlerhood, and early childhood differ in their behavioral problems in early childhood.</p>
</section><section class="level3"><h4 id="step-6b--plot-potential-outcomes-by-exposure-histories">Step 6b. Plot Potential Outcomes by Exposure Histories<a class="anchor" aria-label="anchor" href="#step-6b--plot-potential-outcomes-by-exposure-histories"></a>
</h4>
<p>Lastly, we plot the results. The user has the option to supply <code>save.out</code> to save plot output to the home directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span>, </span>
<span>     save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Workflow_Continuous_Exposure_files/figure-html/unnamed-chunk-78-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<section class="level4"><h5 id="sensitvity-analyses-2">Sensitvity Analyses<a class="anchor" aria-label="anchor" href="#sensitvity-analyses-2"></a>
</h5>
<p>We then conduct sensitivity analyses by assessing and comparing histories drawing from models that used weights trimmed at two different values. Of note if <code>save.out</code> = TRUE using the default file naming, saving the model output will overwrite the output from the main model. To save out sensitivity analyses, we recommend the user supply a new name (e.g., <code>save.out</code> = “history_comparisons_s1.rds”).</p>
<p>We first compare the same histories using the model fit with weights trimmed at the 92nd quantile value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">models.s1</span> </span>
<span></span>
<span><span class="va">results.s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compareHistories.html">compareHistories</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">model</span>, </span>
<span>                            comparison <span class="op">=</span> <span class="va">comparison</span>, </span>
<span>                            reference <span class="op">=</span> <span class="va">reference</span>, </span>
<span>                            hi_lo_cut <span class="op">=</span> <span class="va">hi_lo_cut</span>,</span>
<span>                            mc_comp_method <span class="op">=</span> <span class="va">mc_comp_method</span>, </span>
<span>                            dose <span class="op">=</span> <span class="st">"h"</span>,</span>
<span>                            save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in pool.vector(w, dfcom = dfcom, custom.t = custom.t, rule = rule):</span></span>
<span><span class="co">#&gt; Large sample assumed.</span></span>
<span><span class="co">#&gt; Warning in pool.vector(w, dfcom = dfcom, custom.t = custom.t, rule = rule):</span></span>
<span><span class="co">#&gt; Large sample assumed.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results.s1</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt;                term   estimate  std.error statistic       df    p.value</span></span>
<span><span class="co">#&gt; 1 (h-h-h) - (l-l-l) 0.03327779 0.01659936  2.004764 6.875314 0.08575957</span></span>
<span><span class="co">#&gt;       conf.low  conf.high     conf.low  conf.high  dose p.value_corr</span></span>
<span><span class="co">#&gt; 1 -0.006118212 0.07267379 -0.006118212 0.07267379 3 - 0   0.08575957</span></span></code></pre></div>
</div>
<p>As shown above, results indicate a marginal but non-significant contrast between “l-l-l” and “h-h-h” histories of economic strain exposure in relation to behavior problems in early childhood.</p>
<p><br></p>
<p>We then compare the same histories using the model fit with weights trimmed at the 98th quantile value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">models.s2</span> </span>
<span></span>
<span><span class="va">results.s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compareHistories.html">compareHistories</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">model</span>, </span>
<span>                            comparison <span class="op">=</span> <span class="va">comparison</span>, </span>
<span>                            reference <span class="op">=</span> <span class="va">reference</span>, </span>
<span>                            hi_lo_cut <span class="op">=</span> <span class="va">hi_lo_cut</span>,</span>
<span>                            mc_comp_method <span class="op">=</span> <span class="va">mc_comp_method</span>, </span>
<span>                            dose <span class="op">=</span> <span class="st">"h"</span>,</span>
<span>                            save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in pool.vector(w, dfcom = dfcom, custom.t = custom.t, rule = rule):</span></span>
<span><span class="co">#&gt; Large sample assumed.</span></span>
<span><span class="co">#&gt; Warning in pool.vector(w, dfcom = dfcom, custom.t = custom.t, rule = rule):</span></span>
<span><span class="co">#&gt; Large sample assumed.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results.s2</span>, </span>
<span>        save.out <span class="op">=</span> <span class="va">save.out</span><span class="op">)</span></span>
<span><span class="co">#&gt;                term   estimate  std.error statistic      df   p.value</span></span>
<span><span class="co">#&gt; 1 (h-h-h) - (l-l-l) 0.02640764 0.02274019  1.161276 2.65527 0.3392193</span></span>
<span><span class="co">#&gt;      conf.low conf.high    conf.low conf.high  dose p.value_corr</span></span>
<span><span class="co">#&gt; 1 -0.05157867  0.104394 -0.05157867  0.104394 3 - 0    0.3392193</span></span></code></pre></div>
</div>
<p>Similarly, we find no evidence for differences in behavioral problems as function of history of exposure to economic strain.</p>
<p><br><br></p>
</section></section></section></b></b></section><b><b>
<section class="level1"><h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<p>Arel-Bundock, V. 2024. marginaleffects: Predictions, Comparisons, Slopes, Marginal Means,and Hypothesis Tests. https://CRAN.R-project.org/package=marginaleffects.</p>
<p>Burchinal, M., Howes, C., Pianta, R., Bryant, D., Early, D., Clifford, R., &amp; Barbarin, O. (2008). Predicting Child Outcomes at the End of Kindergarten from the Quality of Pre-Kindergarten Teacher–Child Interactions and Instruction. Applied Developmental Science, 12(3), 140–153. https://doi.org/10.1080/10888690802199418</p>
<p>Cole, S. R., &amp; Hernán, M. A. (2008). Constructing Inverse Probability Weights for Marginal Structural Models. American Journal of Epidemiology, 168(6), 656–664. https://doi.org/10.1093/aje/kwn164.</p>
<p>Greifer N (2024). cobalt: Covariate Balance Tables and Plots. R package version 4.5.2, <a href="https://github.com/ngreifer/cobalt" class="external-link uri">https://github.com/ngreifer/cobalt</a>, <a href="https://ngreifer.github.io/cobalt/" class="external-link uri">https://ngreifer.github.io/cobalt/</a></p>
<p>Greifer N (2024). WeightIt: Weighting for Covariate Balance in Observational Studies. <a href="https://ngreifer.github.io/WeightIt/" class="external-link uri">https://ngreifer.github.io/WeightIt/</a>, <a href="https://github.com/ngreifer/WeightIt" class="external-link uri">https://github.com/ngreifer/WeightIt</a></p>
<p>Polley, Eric, Erin LeDell, Chris Kennedy, and Mark van der Laan. 2023. SuperLearner: SuperLearner Prediction. https://CRAN.R-project.org/package=SuperLearner.</p>
<p>R Core Team (2024). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. ISBN 3-900051-07-0, URLhttp://www.R-project.org/.</p>
<p>Stuart, E. A. (2010). Matching methods for causal inference: A review and a look forward. Statistical Science: A Review Journal of the Institute of Mathematical Statistics, 25(1), 1–21. https://doi.org/10.1214/09-STS313.</p>
<p>Thoemmes, F., &amp; Ong, A. D. (2016). A Primer on Inverse Probability of Treatment Weighting and Marginal Structural Models. https://doi.org/10.1177/2167696815621645.</p>
<p>Vernon-Feagans, L., Cox, M., Willoughby, M., Burchinal, M., Garrett-Peters, P., Mills-Koonce, R., Garrett-Peiers, P., Conger, R. D., &amp; Bauer, P. J. (2013). The Family Life Project: An Epidemiological and Developmental Study of Young Children Living in Poor Rural Communities. Monographs of the Society for Research in Child Development, 78(5), i–150.</p>
</section></b></b>



  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isabella Stallworthy, Noah Greifer, Meriah DeJoseph, Emily Padrutt, Kyle Butts, Daniel Berry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
